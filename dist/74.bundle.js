(function(){(this||window).webpackJsonp.registerAbsMids({"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/WGLDisplayRecord":1440,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/util/serializationUtils":1456,"esri/core/HandleOwner":1472,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/core/HandleOwner":1472,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":1473,"esri/renderers":1475,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/renderers":1475,"esri/layers/support/LabelClass":1476,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/layers/support/LabelClass":1476,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/layers/support/labelUtils":1496,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/MaterialInfo":1501,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/MaterialKeyInfo":1502,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/layers/support/types":1514,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/MaterialInfoUtils":1527,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/collisions/BoundingBox":1531,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/util/Writer":1544,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/core/string":1548,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/layers/support/LabelExpressionInfo":1549,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/MaterialInfoUtils_updateMaterialVariations":1563,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/WGLDisplayObject":1615,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":1616,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":1617,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":1618,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/util/vvFlagUtils":1619,"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":1634,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":1634,"esri/views/2d/engine/webgl/util/BidiText":1635,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/util/BidiText":1635,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/fontUtils":1636,"esri/core/SetPool":1715,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/core/SetPool":1715,"esri/views/2d/layers/features/processors/BaseProcessor":1716,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/MeshData":1717,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/collisions/Metric":1718,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/mesh/VertexVector":1719,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/mesh/templates/meshTemplateUtils":1720,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":1721,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/mesh/Tesselator":1722,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/core/libs/libtess/libtess":1723,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":1724,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/blank-esri-webpack-app/node_modules/arcgis-js-api/views/2d/engine/webgl/util/Matcher":1725,"esri/views/2d/layers/features/processors/SymbolProcessor":2170,"esri/core/MapPool":2171})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{1440:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(1717)],void 0===(n=function(e,t,r,i){var n=r.getLogger("esri/views/2d/engine/webgl/WGLDisplayRecord");return function(){function e(e,t,r){this.id=e,this.geometryType=t,this._materialInfo=r,this.meshData=null,this.symbolLevel=0,this.zOrder=0,this.vertexFrom=0,this.vertexCount=0,this.indexFrom=0,this.indexCount=0}return Object.defineProperty(e.prototype,"sortKey",{get:function(){return void 0===this._sortKey&&this._computeSortKey(),this._sortKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"materialInfo",{get:function(){return"number"==typeof this._materialInfo?(n.warn("Tried to read materialInfo, but found an index! Was materialInfo deserialized correctly?"),null):this._materialInfo},set:function(e){this._materialInfo=e},enumerable:!0,configurable:!0}),e.prototype.copy=function(){var t=new e(this.id,this.geometryType,this._materialInfo);return t.vertexFrom=this.vertexFrom,t.vertexCount=this.vertexCount,t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t.zOrder=this.zOrder,t.symbolLevel=this.symbolLevel,t.meshData=this.meshData,t},e.prototype.setMeshDataFromBuffers=function(e,t,r){var n=new i;for(var s in t){for(var o=t[s].stride,a=t[s].data,l=[],u=0;u<o*e.vertexCount/4;++u)l[u]=a[u+o*e.vertexFrom/4];n.vertexData.set(s,l)}n.indexData.length=0;for(u=0;u<e.indexCount;++u)n.indexData[u]=r[u+e.indexFrom]-e.vertexFrom;n.vertexCount=e.vertexCount,this.meshData=n},e.prototype.readMeshDataFromBuffers=function(e,t){for(var r in this.meshData?this.meshData.clear():this.meshData=new i,e){for(var n=e[r].stride,s=e[r].data,o=[],a=0;a<n*this.vertexCount/4;++a)o[a]=s[a+n*this.vertexFrom/4];this.meshData.vertexData.set(r,o)}this.meshData.indexData.length=0;for(a=0;a<this.indexCount;++a)this.meshData.indexData[a]=t[a+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount},e.prototype.writeMeshDataToBuffers=function(e,t,r,i){for(var n in t)for(var s=t[n].stride,o=this.meshData.vertexData.get(n),a=t[n].data,l=0;l<s*this.meshData.vertexCount/4;++l)a[l+s*e/4]=o[l];for(l=0;l<this.meshData.indexData.length;++l)i[l+r]=this.meshData.indexData[l]+e;this.vertexFrom=e,this.vertexCount=this.meshData.vertexCount,this.indexFrom=r,this.indexCount=this.meshData.indexData.length},e.writeAllMeshDataToBuffers=function(e,t,r){for(var i=0,n=0,s=0,o=e;s<o.length;s++){var a=o[s];a.writeMeshDataToBuffers(i,t,n,r),i+=a.vertexCount,n+=a.indexCount}},e.prototype._computeSortKey=function(){this._sortKey=(31&this.symbolLevel)<<12|(127&this.zOrder)<<4|7&this.geometryType},e.prototype.serialize=function(e){return e.writeInt32(this.geometryType),e.writeInt32(this._materialInfo),e.writeInt32(this.symbolLevel),e.writeInt32(this.zOrder),e.writeInt32(this.vertexFrom),e.writeInt32(this.vertexCount),e.writeInt32(this.indexFrom),e.writeInt32(this.indexCount),e},e.deserialize=function(t,r){var i=t.readInt32(),n=r.store&&r.store.get(t.readInt32())||t.readInt32(),s=new e(r.id,i,n);return s.symbolLevel=t.readInt32(),s.zOrder=t.readInt32(),s.vertexFrom=t.readInt32(),s.vertexCount=t.readInt32(),s.indexFrom=t.readInt32(),s.indexCount=t.readInt32(),s},e}()}.apply(null,i))||(e.exports=n)},1456:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.serializeList=function(e,t){if(null!==t){e.writeInt32(t.length);for(var r=0,i=t;r<i.length;r++)i[r].serialize(e);return e}e.writeInt32(0)},t.deserializeList=function(e,t,r){for(var i=e.readInt32(),n=new Array(i),s=0;s<n.length;s++)n[s]=t.deserialize(e,r);return n}}.apply(null,i))||(e.exports=n)},1472:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(4),r(16),r(1)],void 0===(n=function(e,t,r,i,n,s,o){return function(e){function t(){var t=e.call(this)||this;return t.handles=new s,t}return r(t,e),t.prototype.destroy=function(){this.handles.destroy()},i([o.property({readOnly:!0})],t.prototype,"handles",void 0),i([o.subclass("esri.core.HandleOwner")],t)}(o.declared(n))}.apply(null,i))||(e.exports=n)},1473:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(){}}();t.default=i}.apply(null,i))||(e.exports=n)},1475:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1492),r(1493),r(1432),r(1482),r(1494),r(1453)],void 0===(n=function(e,t,r,i,n,s,o,a){Object.defineProperty(t,"__esModule",{value:!0}),t.ClassBreaksRenderer=r,t.HeatmapRenderer=i,t.BaseRenderer=n,t.SimpleRenderer=s,t.UniqueValueRenderer=o,t.isRenderer=function(e){return e instanceof t.BaseRenderer},t.fromJSON=a.fromJSON}.apply(null,i))||(e.exports=n)},1476:function(e,t,r){var i,n;i=[r(216),r(12),r(5),r(24),r(156),r(1549),r(1496),r(1514),r(151),r(97),r(150),r(204)],void 0===(n=function(e,t,r,i,n,s,o,a,l,u,p,h){function c(e){var t=l.createSyntaxTree(e),r=t&&t.body&&t.body[0]&&t.body[0].body&&t.body[0].body.body;if(!r||1!==r.length)return null;var i="ExpressionStatement"===r[0].type&&r[0].expression;if(!i||"MemberExpression"!==i.type)return null;var n=i.object;if(!n||"Identifier"!==n.type||"$feature"!==n.name)return null;var s=i.property;if(!s)return null;switch(s.type){case"Literal":return s.value;case"Identifier":return s.name}return null}function d(e){return!e||"service"!==e.origin&&(!e.layer||!a.isOfType(e.layer,"map-image"))}var f=i({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"}),g=new u,v=t.createSubclass({declaredClass:"esri.layers.support.LabelClass",properties:{name:{type:String,value:null,json:{write:!0}},labelExpression:{type:String,value:null,json:{read:function(e,t,r,i){var n=t.labelExpressionInfo;if(!n||!n.value&&!n.expression)return e},write:{allowNull:!0,writer:function(e,t,r,i){if(this.labelExpressionInfo&&d(i))if(null!=this.labelExpressionInfo.value)e=this._templateStringToSql(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){var n=c(this.labelExpressionInfo.expression);n&&(e="["+n+"]")}null!=e&&(t[r]=e)}}}},labelExpressionInfo:{value:null,type:s,json:{write:{overridePolicy:function(e,t,r){return d(r)?{allowNull:!0}:{enabled:!1}},writer:function(e,t,r,i){if(null==e&&null!=this.labelExpression&&d(i))e=new s({expression:this.getLabelExpressionArcade()});else if(!e)return;var n=e.toJSON(i);n.expression&&(t[r]=n)}}}},labelPlacement:{type:String,value:null,json:{read:function(e,t){return f.fromJSON(e)},write:function(e,t){var r=f.toJSON(e);r&&(t.labelPlacement=r)}}},maxScale:{type:Number,value:0,json:{write:function(e,t){(e||this.minScale)&&(t.maxScale=e)}}},minScale:{type:Number,value:0,json:{write:function(e,t){(e||this.maxScale)&&(t.minScale=e)}}},requiredFields:{readOnly:!0,dependsOn:["labelExpression","labelExpressionInfo","where"],get:function(){var e=Object.create(null);return this._collectRequiredFields(e),Object.keys(e)}},symbol:{value:null,types:h.labelTypes,json:{origins:{"web-scene":{read:p.read,write:{target:{symbol:{types:h.labelTypes3D}},writer:p.writeTarget}}},read:p.read,write:p.writeTarget}},useCodedValues:{type:Boolean,value:null,json:{write:!0}},where:{type:String,value:null,json:{write:!0}}},getLabelExpression:function(){var e={expression:"",type:"none"};return this.labelExpressionInfo?this.labelExpressionInfo.value?(e.expression=this.labelExpressionInfo.value,e.type="conventional"):this.labelExpressionInfo.expression&&(e.expression=this.labelExpressionInfo.expression,e.type="arcade"):null!=this.labelExpression&&(e.expression=this._sqlToTemplateString(this.labelExpression),e.type="conventional"),e},getLabelExpressionArcade:function(){var e=this.getLabelExpression();if(!e)return null;switch(e.type){case"conventional":return o.convertTemplatedStringToArcade(e.expression);case"arcade":return e.expression}return null},getOptions:function(e){var t={spatialReference:e},r=this.labelExpressionInfo;if(r){var i=r.expression;i&&!r.value&&(t.hasArcadeExpression=!0,t.compiledArcadeFunc=l.createFunction(i))}return t},getLabelExpressionSingleField:function(){var e=this.getLabelExpression();if(!e)return null;switch(e.type){case"conventional":return function(e){var t=e.match(_);return t&&t[1].trim()||null}(e.expression);case"arcade":return c(e.expression)}return null},clone:function(){return new v({labelExpression:this.labelExpression,labelExpressionInfo:r.clone(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:this.symbol.clone(),where:this.where,useCodedValues:this.useCodedValues})},_collectRequiredFields:function(e){this._collectLabelExpressionRequiredFields(this.getLabelExpression(),e),this._collectWhereRequiredFields(this.where,e)},_sqlToTemplateString:function(e){return e.replace(new RegExp("\\[","g"),"{").replace(new RegExp("\\]","g"),"}")},_templateStringToSql:function(e){return e.replace(new RegExp("\\{","g"),"[").replace(new RegExp("\\}","g"),"]")},_collectWhereRequiredFields:function(e,t){if(null!=e){var r=e.split(" ");3===r.length&&(t[r[0]]=!0),7===r.length&&(t[r[0]]=!0,t[r[4]]=!0)}},_collectLabelExpressionRequiredFields:function(e,t){if("arcade"===e.type)l.extractFieldNames(e.expression).forEach(function(e){t[e]=!0});else{var r=e.expression.match(/{[^}]*}/g);r&&r.forEach(function(e){t[e.slice(1,-1)]=!0})}}});v.evaluateWhere=function(e,t){var r=function(e,t,r){switch(t){case"=":return e==r;case"<>":return e!=r;case">":return e>r;case">=":return e>=r;case"<":return e<r;case"<=":return e<=r}return!1};try{if(null==e)return!0;var i=e.split(" ");if(3===i.length)return r(t[i[0]],i[1],i[2]);if(7===i.length){var n=r(t[i[0]],i[1],i[2]),s=i[3],o=r(t[i[4]],i[5],i[6]);switch(s){case"AND":return n&&o;case"OR":return n||o}}return!1}catch(t){console.log("Error.: can't parse = "+e)}},v.buildLabelText=function(e,t,r,i){var n="";if(i&&i.hasArcadeExpression){if(i.compiledArcadeFunc){g.repurposeFromGraphicLikeObject(t.geometry,t.attributes,{fields:r});var s={vars:{$feature:g},spatialReference:i.spatialReference},o=l.executeFunction(i.compiledArcadeFunc,s);null!=o&&(n=o.toString())}}else{var a=t&&t.attributes||{};n=e.replace(/{[^}]*}/g,function(e){return v.formatField(e.slice(1,-1),e,a,r,i)})}return n},v.formatField=function(t,i,s,o,a){var l,u,p=i,h=t.toLowerCase();for(l=0;l<o.length;l++)if(o[l].name.toLowerCase()===h){p=s[o[l].name];var c=o[l].domain;if(c&&"object"==typeof c){if("codedValue"==c.type)for(u=0;u<c.codedValues.length;u++)c.codedValues[u].code==p&&(p=c.codedValues[u].name);else"range"==c.type&&c.minValue<=p&&p<=c.maxValue&&(p=c.name);return null==p?"":p}var d=o[l].type;if("date"==d){var f=e.fromJSON(a&&a.dateFormat||"shortDate"),g="DateFormat"+e.getFormat(f);g&&(p=r.substitute({myKey:p},"{myKey:"+g+"}"))}else"integer"!=d&&"small-integer"!=d&&"long"!=d&&"double"!=d||a&&a.numberFormat&&a.numberFormat.digitSeparator&&a.numberFormat.places&&(p=n.format(p,{places:a.numberFormat.places}))}return null==p?"":p};var _=/^\s*\{([^}]+)\}\s*$/i;return v}.apply(null,i))||(e.exports=n)},1496:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1548)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i="__begin__",n="__end__",s=new RegExp(i,"ig"),o=new RegExp(n,"ig"),a=new RegExp("^"+i,"i"),l=new RegExp(n+"$","i"),u='"',p=u+" + ",h=" + "+u;t.convertTemplatedStringToArcade=function(e){var t;return e?(t=r.replace(e,function(e,t){return i+'$feature["'+t+'"]'+n}),t=a.test(t)?t.replace(a,""):u+t,t=(t=l.test(t)?t.replace(l,""):t+u).replace(s,p).replace(o,h)):t='""',t}}.apply(null,i))||(e.exports=n)},1501:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1298),r(1527),r(1563),r(1502),r(1456)],void 0===(n=function(e,t,r,i,n,s,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t,r){this.unit=e,this.pageId=t,this.semantic=r}return e.prototype.clone=function(){return new e(this.unit,this.pageId,this.semantic)},e.prototype.serialize=function(e){return e.writeInt32(this.unit),e.writeInt32(this.pageId),e},e.deserialize=function(t){return new e(t.readInt32(),t.readInt32(),"u_texture")},e}();t.TexBindingInfo=a;var l=function(){function e(e,t){this.name=e,this.value=t}return e.prototype.clone=function(){return new e(this.name,this.value)},e.prototype.serialize=function(e){return e.writeInt32(this.value),e},e.deserialize=function(t){return new e("u_my_param",t.readInt32())},e}();t.MaterialParam=l;var u=function(){function e(){this.texBindingInfo=[],this.materialParams=[]}return e.fromSprite=function(t,n,o){var l=new e,u=new s;return u.geometryType=n,t?(u.sdf=t.sdf,u.pattern=!0,l.texBindingInfo.push(new a(1,t.page,"u_texture"))):(u.sdf=!1,u.pattern=!1),0===o?u.vvOpacity=u.vvSizeMinMaxValue=u.vvSizeScaleStops=u.vvSizeFieldStops=u.vvSizeUnitValue=u.vvColor=u.vvRotation=!1:(u.vvOpacity=0!=(o&r.WGLVVFlag.OPACITY),u.vvSizeMinMaxValue=0!=(o&r.WGLVVFlag.SIZE_MINMAX_VALUE),u.vvSizeScaleStops=0!=(o&r.WGLVVFlag.SIZE_SCALE_STOPS),u.vvSizeFieldStops=0!=(o&r.WGLVVFlag.SIZE_FIELD_STOPS),u.vvSizeUnitValue=0!=(o&r.WGLVVFlag.SIZE_UNIT_VALUE),u.vvColor=0!=(o&r.WGLVVFlag.COLOR),u.vvRotation=0!=(o&r.WGLVVFlag.ROTATION)),u.visibility=!1,l.materialKey=i.getMaterialKey(u),l.materialKeyInfo=u,l},e.fromGlyph=function(t,n,o){var l=new e,u=new s;return u.geometryType=n,u.sdf=!0,u.pattern=!1,u.visibility=!1,u.heatmap=!1,l.texBindingInfo.push(new a(2,t.page,"u_texture")),0===o?u.vvOpacity=u.vvSizeMinMaxValue=u.vvSizeScaleStops=u.vvSizeFieldStops=u.vvSizeUnitValue=u.vvColor=u.vvRotation=!1:(u.vvOpacity=0!=(o&r.WGLVVFlag.OPACITY),u.vvSizeMinMaxValue=0!=(o&r.WGLVVFlag.SIZE_MINMAX_VALUE),u.vvSizeScaleStops=0!=(o&r.WGLVVFlag.SIZE_SCALE_STOPS),u.vvSizeFieldStops=0!=(o&r.WGLVVFlag.SIZE_FIELD_STOPS),u.vvSizeUnitValue=0!=(o&r.WGLVVFlag.SIZE_UNIT_VALUE),u.vvColor=0!=(o&r.WGLVVFlag.COLOR),u.vvRotation=0!=(o&r.WGLVVFlag.ROTATION)),l.materialKey=i.getMaterialKey(u),l.materialKeyInfo=u,l},e.prototype.copy=function(e){this.materialParams=e.materialParams.map(function(e){return e.clone()}),this.texBindingInfo=e.texBindingInfo.map(function(e){return e.clone()}),e.materialKeyInfo&&(this.materialKeyInfo=new s,this.materialKeyInfo.copy(e.materialKeyInfo)),this.materialKey=e.materialKey},e.prototype.serialize=function(e){return e.writeInt32(this.materialKey),o.serializeList(e,this.texBindingInfo),o.serializeList(e,this.materialParams),e},e.deserialize=function(t){var r=new e;return r.materialKey=t.readInt32(),r.texBindingInfo=o.deserializeList(t,a),r.materialParams=o.deserializeList(t,l),r.materialKeyInfo=new s,n(r.materialKeyInfo,r.materialKey),r},e}();t.default=u}.apply(null,i))||(e.exports=n)},1502:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(){this.sdf=!1,this.vvSizeMinMaxValue=!1,this.vvSizeScaleStops=!1,this.vvSizeFieldStops=!1,this.vvSizeUnitValue=!1,this.vvColor=!1,this.vvRotation=!1,this.vvOpacity=!1,this.visibility=!1,this.pattern=!1,this.heatmap=!1}return e.prototype.copy=function(e){this.geometryType=e.geometryType,this.sdf=e.sdf,this.vvSizeMinMaxValue=e.vvSizeMinMaxValue,this.vvSizeScaleStops=e.vvSizeScaleStops,this.vvSizeFieldStops=e.vvSizeFieldStops,this.vvSizeUnitValue=e.vvSizeUnitValue,this.vvColor=e.vvColor,this.vvRotation=e.vvRotation,this.vvOpacity=e.vvOpacity,this.visibility=e.visibility,this.pattern=e.pattern,this.heatmap=e.heatmap},e.prototype.hasVV=function(){return void 0===this._hasVV&&(this._hasVV=this.vvColor||this.vvOpacity||this.vvRotation||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue),this._hasVV},e.prototype.hasVVSize=function(){return this.vvSizeMinMaxValue||this.vvSizeFieldStops||this.vvSizeScaleStops||this.vvSizeUnitValue},e.prototype.hasVVColor=function(){return this.vvColor},e.prototype.hasVVRotation=function(){return this.vvRotation},e.prototype.hasVVOpacity=function(){return this.vvOpacity},e}()}.apply(null,i))||(e.exports=n)},1514:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isOfType=function(e,t){var r=e.constructor._meta;if(!r||!r.bases)return!1;var i=r.bases,n=Array.isArray(t);return i.some(function(e){var r=e.__accessorMetadata__;if(!r)return!1;var i=r.properties;if(!i||!i.type||!i.type.value)return!1;var s=i.type.value;return n?-1!==t.indexOf(s):s===t})}}.apply(null,i))||(e.exports=n)},1527:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1298),r(1501),r(1502)],void 0===(n=function(e,t,r,i,n){function s(e){if(e.geometryType===r.WGLGeometryType.UNKNOWN)return-1;var t=function(e){var t=[];return t[0]=!!e.sdf,t[1]=!!e.vvSizeMinMaxValue,t[2]=!!e.vvSizeScaleStops,t[3]=!!e.vvSizeFieldStops,t[4]=!!e.vvSizeUnitValue,t[5]=!!e.vvColor,t[6]=!!e.vvRotation,t[7]=!!e.vvOpacity,t[8]=!!e.visibility,t[9]=!!e.pattern,t[10]=!!e.heatmap,t.reduce(function(e,t,r){return t&&(e|=1<<r+2),e},0)}(e)<<3;return e.geometryType+t}Object.defineProperty(t,"__esModule",{value:!0}),t.createTextMaterialInfo=function(e,t,o){var a=new i.default,l=new n;return l.geometryType=o,l.sdf=!0,l.pattern=!1,l.visibility=!1,l.heatmap=!1,a.texBindingInfo.push(new i.TexBindingInfo(2,e.page,"u_texture")),0===t?l.vvOpacity=l.vvSizeMinMaxValue=l.vvSizeScaleStops=l.vvSizeFieldStops=l.vvSizeUnitValue=l.vvColor=l.vvRotation=!1:(l.vvOpacity=0!=(t&r.WGLVVFlag.OPACITY),l.vvSizeMinMaxValue=0!=(t&r.WGLVVFlag.SIZE_MINMAX_VALUE),l.vvSizeScaleStops=0!=(t&r.WGLVVFlag.SIZE_SCALE_STOPS),l.vvSizeFieldStops=0!=(t&r.WGLVVFlag.SIZE_FIELD_STOPS),l.vvSizeUnitValue=0!=(t&r.WGLVVFlag.SIZE_UNIT_VALUE),l.vvColor=0!=(t&r.WGLVVFlag.COLOR),l.vvRotation=0!=(t&r.WGLVVFlag.ROTATION)),a.materialKey=s(l),a.materialKeyInfo=l,a},t.createMaterialInfo=function(e,t,o){var a=new i.default,l=new n;if(l.geometryType=t,e){var u=e.spriteMosaicItem;l.sdf=u.sdf,l.pattern=!0,a.texBindingInfo.push(new i.TexBindingInfo(1,u.page,"u_texture"))}else l.sdf=!1,l.pattern=!1;return 0===o?l.vvOpacity=l.vvSizeMinMaxValue=l.vvSizeScaleStops=l.vvSizeFieldStops=l.vvSizeUnitValue=l.vvColor=l.vvRotation=!1:(l.vvOpacity=0!=(o&r.WGLVVFlag.OPACITY),l.vvSizeMinMaxValue=0!=(o&r.WGLVVFlag.SIZE_MINMAX_VALUE),l.vvSizeScaleStops=0!=(o&r.WGLVVFlag.SIZE_SCALE_STOPS),l.vvSizeFieldStops=0!=(o&r.WGLVVFlag.SIZE_FIELD_STOPS),l.vvSizeUnitValue=0!=(o&r.WGLVVFlag.SIZE_UNIT_VALUE),l.vvColor=0!=(o&r.WGLVVFlag.COLOR),l.vvRotation=0!=(o&r.WGLVVFlag.ROTATION)),l.visibility=!1,a.materialKey=s(l),a.materialKeyInfo=l,a},t.getMaterialKey=s,t.getMaterialVariations=function(e){return{geometryType:7&e,variations:[0!=(1&(e>>=3)),0!=(2&e),0!=(4&e),0!=(8&e),0!=(16&e),0!=(32&e),0!=(64&e),0!=(128&e),0!=(256&e),0!=(512&e),0!=(1024&e),0!=(2048&e),0!=(4096&e)]}}}.apply(null,i))||(e.exports=n)},1531:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(419)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,n){this.width=i,this.height=n,this.center=r.fromValues(e,t)}return Object.defineProperty(e.prototype,"x",{get:function(){return this.center[0]},set:function(e){this.center[0]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.center[1]},set:function(e){this.center[1]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"halfWidth",{get:function(){return this.width/2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"halfHeight",{get:function(){return this.height/2},enumerable:!0,configurable:!0}),e.prototype.serialize=function(e){return e.writeF32(this.center[0]),e.writeF32(this.center[1]),e.writeInt32(this.width),e.writeInt32(this.height),e},e.deserialize=function(t){return new e(t.readF32(),t.readF32(),t.readInt32(),t.readInt32())},e}();t.default=i}.apply(null,i))||(e.exports=n)},1544:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this._pos=0;var r=t?this._roundToNearest4(t):40;this._array=new ArrayBuffer(r),this._buffer=new e(this._array),this._ctor=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._pos},enumerable:!0,configurable:!0}),e.prototype._roundToNearest4=function(e){var t=Math.round(e);return t+(4-t%4)},e.prototype._ensureSize=function(e){if(this._pos+e>=this._buffer.length){var t=this._roundToNearest4(1.5*(this._array.byteLength+4*e)),r=new ArrayBuffer(t),i=new this._ctor(r);i.set(this._buffer,0),this._array=r,this._buffer=i}},e.prototype.writeInt32=function(e){this._ensureSize(1);var t=this._pos;return this._buffer[this._pos++]=e,t},e.prototype.writeF32=function(e){this._ensureSize(1);var t=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=e,this._pos++,t},e.prototype.writeUint32=function(e){this._ensureSize(1);var t=this._pos;return this._buffer[this._pos++]=e,t},e.prototype.push=function(e){this._ensureSize(1);var t=this._pos;return this._buffer[this._pos++]=e,t},e.prototype.writeRegion=function(e){this._ensureSize(e.length);var t=this._pos;return this._buffer.set(e,this._pos),this._pos+=e.length,t},e.prototype.buffer=function(){var e=this._array.slice(0,4*this._pos);return this.destroy(),e},e.prototype.destroy=function(){this._array=null,this._buffer=null},e}();t.default=r}.apply(null,i))||(e.exports=n)},1548:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(82)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.replace=function(e,t,i){return void 0===i&&(i=/\{([^\}]+)\}/g),e.replace(i,"function"==typeof t?t:function(e,i){return r.getDeepValue(i,t)})}}.apply(null,i))||(e.exports=n)},1549:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(12),r(1),r(1496)],void 0===(n=function(e,t,r,i,n,s,o){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.expression=null,t}var n;return r(t,e),n=t,t.prototype.readExpression=function(e,t){return t.value?o.convertTemplatedStringToArcade(t.value):e},t.prototype.writeExpression=function(e,t,r){null!=this.value&&(e=o.convertTemplatedStringToArcade(this.value)),t[r]=e},t.prototype.clone=function(){return new n({value:this.value,expression:this.expression})},i([s.property({json:{read:!1,write:!1}})],t.prototype,"value",void 0),i([s.property({json:{write:{allowNull:!0}}})],t.prototype,"expression",void 0),i([s.reader("expression",["expression","value"])],t.prototype,"readExpression",null),i([s.writer("expression")],t.prototype,"writeExpression",null),n=i([s.subclass("esri.layers.support.LabelExpressionInfo")],t)}(s.declared(n))}.apply(null,i))||(e.exports=n)},1563:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){return function(e,t){return e.geometryType=7&t,t>>=3,e.sdf=0!=(4&t),e.vvSizeMinMaxValue=0!=(8&t),e.vvSizeScaleStops=0!=(16&t),e.vvSizeFieldStops=0!=(32&t),e.vvSizeUnitValue=0!=(64&t),e.vvColor=0!=(128&t),e.vvRotation=0!=(256&t),e.vvOpacity=0!=(512&t),e.visibility=0!=(1024&t),e.pattern=0!=(2048&t),e.heatmap=0!=(4096&t),e}}.apply(null,i))||(e.exports=n)},1615:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(419),r(1440),r(1718),r(1456)],void 0===(n=function(e,t,r,i,n,s){return function(){function e(e){this.xBucket=-1,this.yBucket=-1,this.xOverflow=-1,this.yOverflow=-1,this.id=e,this.displayRecords=[],this.metrics=[],this.anchor=null}return e.prototype.copy=function(){var t=new e(this.id);return t.set(this),t},e.prototype.set=function(e){this.id=e.id,this.displayRecords=e.displayRecords,this.metrics=e.metrics,this.anchor=e.anchor,this.xBucket=e.xBucket,this.yBucket=e.yBucket,this.xOverflow=e.xOverflow,this.yOverflow=e.yOverflow},e.prototype.addMetric=function(e,t,r,i){this.metrics.push(new n.default(e,{from:t,count:r},i))},e.prototype.serialize=function(e){return e.writeInt32(this.id),s.serializeList(e,this.metrics),s.serializeList(e,this.displayRecords),this.anchor?(e.writeF32(this.anchor[0]),e.writeF32(this.anchor[1]),e.writeInt32(this.xBucket),e.writeInt32(this.yBucket),e.writeInt32(this.xOverflow),e.writeInt32(this.yOverflow)):(e.writeF32(0),e.writeF32(0)),e},e.deserialize=function(t,o){var a=o.store,l=t.readInt32(),u=new e(l),p={id:l,store:a},h=s.deserializeList(t,n.default);h.length&&(u.metrics=h),u.displayRecords=s.deserializeList(t,i,p);var c=t.readF32(),d=t.readF32();return(c||d)&&(u.anchor=r.fromValues(c,d),u.xBucket=t.readInt32(),u.yBucket=t.readInt32(),u.xOverflow=t.readInt32(),u.yOverflow=t.readInt32()),u},e}()}.apply(null,i))||(e.exports=n)},1616:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(7),r(1431),r(415),r(1298),r(1298),r(1628),r(1435),r(1538),r(1314),r(1440),r(1473)],void 0===(n=function(e,t,r,i,n,s,o,a,l,u,p,h,c,d){Object.defineProperty(t,"__esModule",{value:!0});var f=i.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate"),g=l.allocTriangles(20),v=l.allocTriangles(20),_=[l.allocExtrudeVectors(),l.allocExtrudeVectors()],m=l.allocExtrudeVectors(),y=s.TILE_SIZE+8,x=new l.Tessellator({distanceAlongCorrection:!0}),b=new p.TileClipper(0,0,0,1,8);b.setExtent(512);var w=function(e){function t(t,r,i,n,s,a,l,u,p,h,c){var d=e.call(this)||this;d.capType=a,d.joinType=l,d.fillColor=u,d.tl=p,d.br=h,d.hasPattern=c,d.geometryType=o.WGLGeometryType.LINE;var f=1/s;return d.halfWidth=n>0?.5*(n+f):0,d._materialStore=t,d.vvFlags=r,d.materialId=d._materialStore.createSpriteMaterial(i,d.geometryType,r),d}return r(t,e),t.fromSimpleLine=function(e,r,i,s,o){var a=i.color,l=h.getCapType(i.cap||"round"),p=h.getJoinType(i.join||"round"),c=a&&"none"!==i.style&&n.premultiplyAlphaRGBA(a)||0;if("none"===i.style&&(c=0),!s)return new t(e,r,s,i.width,o,l,p,c,0,0,!1);var d=s.rect,f=s.width,g=s.height,v=d.x+1,_=d.y+1,m=d.x+1+f,y=d.y+1+g,x=u.i1616to32(v,_),b=u.i1616to32(m,y);return new t(e,r,s,i.width,o,l,p,c,x,b,!0)},t.fromPictureLineSymbol=function(e,t,r,i){return f.error("PictureLineSymbol support does not exist!"),null},t.prototype.writeMesh=function(e,t,r,i,n,s,o){if(this.vvFlags&a.WGLVVFlag.COLOR||0!==this.fillColor){var l=this._materialStore.get(this.materialId),u=t.indexVector,p=t.get("geometry"),h=this.halfWidth,d=new c(i,this.geometryType,this.materialId),g=this._getOffset(p,l);switch(d.vertexFrom=g,d.indexFrom=u.length,e.push(d),r){case"esriGeometryPolyline":var v=n.geometry.paths,_=this._clipLines(v);return void this._write(d,u,p,g,i,h,_,l,o);case"esriGeometryPolygon":var m=n.geometry.rings;_=this._clipLines(m);return void this._write(d,u,p,g,i,h,_,l,o);default:f.error("Unable to handle geometryType: "+r)}}},t.prototype._clipLines=function(e){for(var t=[],r=!1,i=0;i<e.length;){var n=[],s=e[i];b.reset(2);var o=s[0],a=o[0],l=o[1];if(r)b.moveTo(a,l);else{if(a<-8||a>y||l<-8||l>y){r=!0;continue}n.push({x:a,y:l})}for(var u=!1,p=s.length,h=1;h<p;++h)if(a+=s[h][0],l+=s[h][1],r)b.lineTo(a,l);else{if(a<-8||a>y||l<-8||l>y){u=!0;break}n.push({x:a,y:l})}if(u)r=!0;else{if(r){var c=b.resultWithStarts();if(c)for(var d=0,f=c;d<f.length;d++){var g=f[d];t.push(g)}}else t.push({line:n,start:0});i++,r=!1}}return t},t.prototype._getOffset=function(e,t){var r=t.materialKeyInfo.hasVV()?11:8;return e.length/r},t.prototype._write=function(e,t,r,i,n,s,o,a,u){for(var p=0,h=0,c=o;h<c.length;h++){var d=c[h],f=d.line,v=d.start;if(!(f.length<2))for(var y=f[0],b=f[f.length-1],w=b.x-y.x,E=b.y-y.y,S=w*w+E*E<1e-6,L=v%65535,T=_[1],I=0;I<f.length;I++){var V=f[I],N=T===_[I%2]?_[(I+1)%2]:_[I%2],G=0===I,O=I===f.length-1;if(O&&S&&!this.hasPattern?l.copyExtrudeVectors(N,m):(this._computeExtrudeVectors(N,I,f,S),p+=this._writeVertices(r,n,s,V.x,V.y,N,L,p,a,u),!N.capCenter||S&&O||this._writePieIndices(e,t,i,N),S&&G&&!this.hasPattern&&l.copyExtrudeVectors(m,N)),G||this._writeBridgeIndices(e,t,i,T,N),!O){var C=f[I+1],R=[C.x-V.x,C.y-V.y],U=l.length(R),M=[R[0]/U,R[1]/U],D=L+U;if(D>65535){var F=(65535-L)/(D-L),P=V.x+(C.x-V.x)*F,A=V.y+(C.y-V.y)*F,k=T;x.buttCap(k,M,M),p+=this._writeVertices(r,n,s,P,A,k,65535,p,a,u),x.bridge(g,N,k),this._writeBridgeIndices(e,t,i,N,k),x.buttCap(k,M,M),L=D-65535}else L=D,T=N}}}e.vertexCount=p},t.prototype._writeVertices=function(e,t,r,i,n,s,o,a,l,p){for(var h=0,c=u.i1616to32(i,n),d=s.vectors,f=d.items,g=d.count;h<g;++h){var v=f[h].vector,_=v[0],m=v[1],y=f[h].texCoords,x=y[0],b=y[1],w=f[h].direction,E=w[0],S=w[1],L=u.i1616to32(o,31*r),T=u.i8888to32(Math.round(31*_),Math.round(31*m),Math.round(31*x),Math.round(31*b)),I=u.i8888to32(Math.round(31*E),Math.round(31*S),0,0);e.push(c),e.push(t),e.push(this.fillColor),e.push(T),e.push(L),e.push(this.tl),e.push(this.br),e.push(I),this._writeVV(e,p,l),f[h].base={index:a+h,point:[i,n]}}return h},t.prototype._writeVV=function(e,t,r){r.materialKeyInfo.hasVV()&&(e.push(t[o.VVType.SIZE]),e.push(t[o.VVType.COLOR]),e.push(t[o.VVType.OPACITY]))},t.prototype._writeBridgeIndices=function(e,t,r,i,n){x.bridge(g,i,n);for(var s=0;s<g.count;++s){var o=g.items[s];t.push(r+o.v1.base.index),t.push(r+o.v2.base.index),t.push(r+o.v3.base.index),e.indexCount+=3}},t.prototype._writePieIndices=function(e,t,r,i){x.pie(v,i);for(var n=0;n<v.count;++n){var s=v.items[n];t.push(r+s.v1.base.index),t.push(r+s.v2.base.index),t.push(r+s.v3.base.index),e.indexCount+=3}},t.prototype._computeExtrudeVectors=function(e,t,r,i){var n=r[t],s=[void 0,void 0],o=[void 0,void 0];if(t>0&&t<r.length-1){var a=r[(t+r.length-1)%r.length],u=r[(t+1)%r.length];l.normalize(s,[n.x-a.x,n.y-a.y]),l.normalize(o,[u.x-n.x,u.y-n.y])}else if(0===t){u=r[(t+1)%r.length];if(l.normalize(o,[u.x-n.x,u.y-n.y]),i){var p=r[r.length-2];l.normalize(s,[n.x-p.x,n.y-p.y])}else s=o}else{if(t!==r.length-1)return void console.error("Vertex index 'i' out of range.");a=r[(t+r.length-1)%r.length];if(l.normalize(s,[n.x-a.x,n.y-a.y]),i){var h=r[1];l.normalize(o,[h.x-n.x,h.y-n.y])}else o=s}i||0!==t?i||t!==r.length-1?this._computeJoinExtrudeVectors(e,s,o):this._computeCapExtrudeVectors(e,s,o,l.CapPosition.END):this._computeCapExtrudeVectors(e,s,o,l.CapPosition.START)},t.prototype._computeCapExtrudeVectors=function(e,t,r,i){switch(this.capType){case o.CapType.BUTT:return void x.buttCap(e,t,r);case o.CapType.ROUND:var n=l.getNumberOfSlices(Math.PI),s=i===l.CapPosition.START?-1:1;return void x.roundCap(e,t,r,i,n,s);case o.CapType.SQUARE:return void x.squareCap(e,t,r,i);default:return f.error("Encountered unknown cap type: "+this.capType+", defaulting to BUTT"),void x.buttCap(e,t,r)}},t.prototype._computeJoinExtrudeVectors=function(e,t,r){var i=l.getRads(t,r);if(i>Math.PI-.05)x.rectJoin(e,t,r);else if(this.joinType===o.JoinType.MITER||i<.1)i<.05?x.fastMiterJoin(e,t,r):i<l.MITER_SAFE_RADS?x.miterJoin(e,t,r):x.bevelJoin(e,t,r,l.SYSTEM_MAG_LIMIT);else if(this.joinType===o.JoinType.BEVEL)x.bevelJoin(e,t,r,1);else if(this.joinType===o.JoinType.ROUND){var n=l.getNumberOfSlices(i);i<2.3?n<2||i<.5?x.bevelJoin(e,t,r,1):x.roundJoin(e,t,r,n):x.unitRoundJoin(e,t,r,n)}},t}(d.default);t.default=w}.apply(null,i))||(e.exports=n)},1617:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(7),r(32),r(439),r(419),r(1431),r(415),r(1298),r(1435),r(1440),r(1473)],void 0===(n=function(e,t,r,i,n,s,o,a,l,u,p,h,c){Object.defineProperty(t,"__esModule",{value:!0});var d=i.getLogger("esri.views.2d.engine.webgl.WGLMeshTemplate"),f=function(e){function t(t,r,i,n,a,l,h,c,d,f,g){var v=e.call(this)||this;v.geometryType=u.WGLGeometryType.MARKER;var _=o.create(),m=s.create(),y=g.sdf?.5:1;s.translate(m,m,new Float32Array([y*i,y*-n])),a&&s.rotate(m,m,3.14159265359/180*a),v._materialStore=t,v.vvFlags=r,v._materialId=t.createSpriteMaterial(g,v.geometryType,r),v._fillColor=l,v._outlineColor=d,v._sizeOutlineWidth=p.i8888to32(h,c,f,0);var x=Math.round(g.rect.x/4),b=Math.round(g.rect.y/4),w=x+Math.round(g.rect.width/4),E=b+Math.round(g.rect.height/4);return _.set([-.5*h,-.5*c]),o.transformMat2d(_,_,m),v._offsetAndTexUpperLeft=p.i8888to32(_[0],_[1],x,b),_.set([.5*h,-.5*c]),o.transformMat2d(_,_,m),v._offsetAndTexUpperRight=p.i8888to32(_[0],_[1],w,b),_.set([-.5*h,.5*c]),o.transformMat2d(_,_,m),v._offsetAndTexBottomLeft=p.i8888to32(_[0],_[1],x,E),_.set([.5*h,.5*c]),o.transformMat2d(_,_,m),v._offsetAndTexBottomRight=p.i8888to32(_[0],_[1],w,E),v.height=c,v.width=h,v.xOffset=i,v.yOffset=n,v}return r(t,e),t.fromPictureMarker=function(e,r,i,s,o){var a=Math.round(n.pt2px(i.width)),u=Math.round(n.pt2px(i.height)),p=l.PICTURE_FILL_COLOR;return new t(e,r,Math.round(n.pt2px(i.xoffset||0)),Math.round(n.pt2px(i.yoffset||0)),i.angle,p,a,u,0,0,s)},t.fromSimpleMarker=function(e,r,i,s,o){var l=a.premultiplyAlphaRGBA(i.color),u=Math.round(n.pt2px(i.size)),p=u,h=Math.round(n.pt2px(i.xoffset||0)),c=Math.round(n.pt2px(i.yoffset||0)),d=i.outline,f=0|(d&&d.color&&a.premultiplyAlphaRGBA(d.color)),g=0|(d&&d.width&&Math.round(n.pt2px(d.width)));return new t(e,r,h,c,i.angle,l,u,p,f,g,s)},t.prototype.writeMesh=function(e,t,r,i,n,s,o){var a=this._materialStore.get(this._materialId),l=t.indexVector,u=t.get("geometry"),p=new h(i,this.geometryType,this._materialId),c=this._getOffset(u,a);switch(e.push(p),p.vertexFrom=c,p.indexFrom=l.length,r){case"esriGeometryPoint":var f=n.geometry,g=f.x,v=f.y;return this._writeVertices(p,u,i,this._getPos(g,v),a,o),void this._writeIndices(p,l,c);case"esriGeometryPolyline":var _=n.geometry.paths;return void this._writeMany(p,l,u,c,i,_[0],a,o);case"esriGeometryPolygon":var m=n.centroid;if(m){g=m.x,v=m.y;this._writeVertices(p,u,i,this._getPos(g,v),a,o),this._writeIndices(p,l,c)}else d.error("Tried to render polygon geometries as markers, but found no centroid!");return;case"esriGeometryMultipoint":var y=n.geometry.points;return void this._writeMany(p,l,u,c,i,y,a,o);case"esriGeometryEnvelope":default:d.error("Unable to handle geometryType: "+r)}},t.prototype._getPos=function(e,t){return p.i1616to32(e,t)},t.prototype._writeMany=function(e,t,r,i,n,s,o,a){for(var l=0,u=0,p=0,h=0,c=s;h<c.length;h++){var d=c[h],f=d[0],g=d[1];this._writeVertices(e,r,n,this._getPos(f+l,g+u),o,a),this._writeIndices(e,t,i+p),l+=f,u+=g,p+=4}},t.prototype._getOffset=function(e,t){var r=t.materialKeyInfo.hasVV()?10:6;return e.length/r},t.prototype._writeVertices=function(e,t,r,i,n,s){t.push(i),t.push(this._offsetAndTexUpperLeft),t.push(r),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),this._writeVV(t,s,n),t.push(i),t.push(this._offsetAndTexUpperRight),t.push(r),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),this._writeVV(t,s,n),t.push(i),t.push(this._offsetAndTexBottomLeft),t.push(r),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),this._writeVV(t,s,n),t.push(i),t.push(this._offsetAndTexBottomRight),t.push(r),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),this._writeVV(t,s,n),e.vertexCount+=4},t.prototype._writeVV=function(e,t,r){r.materialKeyInfo.hasVV()&&(e.push(t[u.VVType.SIZE]),e.push(t[u.VVType.COLOR]),e.push(t[u.VVType.OPACITY]),e.push(t[u.VVType.ROTATION]))},t.prototype._writeIndices=function(e,t,r){var i=r;t.push(i+0),t.push(i+1),t.push(i+2),t.push(i+1),t.push(i+3),t.push(i+2),e.indexCount+=6},t}(c.default);t.default=f}.apply(null,i))||(e.exports=n)},1618:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(7),r(32),r(1431),r(415),r(1298),r(1458),r(1435),r(1537),r(1440),r(1531),r(1473),r(1635)],void 0===(n=function(e,t,r,i,n,s,o,a,l,u,p,h,c,d,f){Object.defineProperty(t,"__esModule",{value:!0});var g=i.getLogger("esri.views.2d.engine.webgl.WGLTextTemplate"),v=10,_=24,m=1.2*_,y=10*_,x=function(){function e(e,t,r,i,n,s,o,a,l){this.materialId=e,this.vertexOffsetUpperLeft=t,this.vertexOffsetUpperRight=r,this.vertexOffsetLowerLeft=i,this.vertexOffsetLowerRight=n,this.texFontSizeUpperLeft=s,this.texFontSizeUpperRight=o,this.texFontSizeLowerLeft=a,this.texFontSizeLowerRight=l}return e.from=function(t,r,i,n,s){var o,a,p=t.glyphMosaicItem,h=p.rect,c=p.metrics,d=Math.round(h.x/4),f=Math.round(h.y/4),g=d+Math.round(h.width/4),v=f+Math.round(h.height/4);if(t.codePoint){var _=t.x+0+c.left,m=t.y+-17-c.top;o=new l.Point(_-4,m-4),a=new l.Point(o.x+h.width,o.y+h.height)}else{_=t.x,m=t.y;o=new l.Point(_,m),a=new l.Point(o.x+c.width,o.y+c.height)}var y=new l.Point(o.x,a.y),x=new l.Point(a.x,o.y);if(i){var b=Math.cos(i),w=Math.sin(i);o.rotate(b,w),a.rotate(b,w),y.rotate(b,w),x.rotate(b,w)}return new e(r,u.i1616to32(8*o.x,8*o.y),u.i1616to32(8*x.x,8*x.y),u.i1616to32(8*y.x,8*y.y),u.i1616to32(8*a.x,8*a.y),u.i8888to32(d,f,n,s),u.i8888to32(g,f,n,s),u.i8888to32(d,v,n,s),u.i8888to32(g,v,n,s))},e}();t.ComputedGlyph=x;var b=function(e){function t(t,r,i){var l=e.call(this)||this;l.geometryType=a.WGLGeometryType.TEXT;var u=i.haloColor;l.color=0|(i.color&&s.premultiplyAlphaRGBA(i.color)),l.textSize=n.pt2px(i.font.size);var p=i.xoffset/i.font.size,h=i.yoffset/i.font.size;return l.shapingXOffset=p*_,l.shapingYOffset=h*_,l.haloColor=0|(u&&s.premultiplyAlphaRGBA(u)),l.haloSize=v*n.pt2px(n.toPt(i.haloSize||0)),l.textPropColor=l.color||o.PICTURE_FILL_COLOR,l.textPropSize=n.pt2px(i.font.size),l.textPropAngle=i.angle*Math.PI/180,l.xOffset=n.pt2px(i.xoffset),l.yOffset=n.pt2px(i.yoffset),l.textPropHAnchor="left"===i.horizontalAlignment?0:"right"===i.horizontalAlignment?1:.5,l.textPropVAnchor="top"===i.verticalAlignment?0:"bottom"===i.verticalAlignment?1:.5,l.textPropHaloColor=l.haloColor||4294967295,l.textPropHaloSize=n.pt2px(n.toPt(i.haloSize||0)),l._materialStore=t,l.vvFlags=r,l}return r(t,e),t.fromText=function(e,r,i,n,s){var o=new t(e,r,i);return o.computeGlyphs(s,i.text,!1),o},t.prototype.writeMesh=function(e,t,r,i,n,s,o){var a=t.indexVector,l=t.get("geometry"),u=t.get("visibility"),p=this._getOffset(l);switch(r){case"esriGeometryPoint":var h=n.geometry,c=h.x,d=h.y;return void this._writeVertices(e,a,l,u,p,i,c,d,o);case"esriGeometryPolygon":if(n.centroid){var f=n.centroid;c=f.x,d=f.y;return void this._writeVertices(e,a,l,u,p,i,c,d,o)}default:g.error("Unable to handle geometryType: "+r)}},t.prototype.computeGlyphs=function(e,t,r){if(!t||!t.length)return this._computedGlyphs=[],null;for(var i=this.shapingXOffset,n=this.shapingYOffset,s=this.textPropHAnchor,o=this.textPropVAnchor,l=this._computeShaping(e,y,m,0,i,n,s,o,.5),u=f.bidiText(t),h=u[0],d=u[1],g=l.getShaping(h,d),v=new Array(g.length),b=0;b<g.length;b++){var w=this.textPropAngle,E=this.textSize,S=this.haloSize,L=g[b].glyphMosaicItem,T=this._materialStore.createGlyphMaterial(L,a.WGLGeometryType.TEXT,this.vvFlags);v[b]=x.from(g[b],T,w,E,S)}if(this._computedGlyphs=v,!r)return null;var I=p.getBox(g);return I.width*=this.textSize/_,I.height*=this.textSize/_,new c.default(I.x,I.y,I.width,I.height)},t.prototype._computeShaping=function(e,t,r,i,n,s,o,a,l){return this._shaping=new p([e],y,m,0,[n,s],o,a,.5),this._shaping},t.prototype._getOffset=function(e){var t=!!this.vvFlags?9:5;return e.length/t},t.prototype._writeVertices=function(e,t,r,i,n,s,o,a,l){var p=this._computedGlyphs,c=o,d=a,f=u.i1616to32(2*c,2*d),g=u.i1616to32(2*c+1,2*d),v=0;if(this.haloSize)for(var _=0;_<p.length;_++,v+=4){var m=p[_].materialId,y=this._materialStore.get(m);(x=new h(s,this.geometryType,m)).vertexFrom=n+v,x.indexFrom=t.length,this._writeVertex(x,r,i,s,g,this.haloColor,p[_],y,l),this._writeIndices(x,t,n+v),e.push(x)}for(_=0;_<p.length;_++,v+=4){var x;m=p[_].materialId,y=this._materialStore.get(m);(x=new h(s,this.geometryType,m)).vertexFrom=n+v,x.indexFrom=t.length,this._writeVertex(x,r,i,s,f,this.color,p[_],y,l),this._writeIndices(x,t,n+v),e.push(x)}},t.prototype._writeVertex=function(e,t,r,i,n,s,o,a,l){t.push(n),t.push(i),t.push(s),t.push(o.vertexOffsetUpperLeft),t.push(o.texFontSizeUpperLeft),this._writeVV(t,l,a),t.push(n),t.push(i),t.push(s),t.push(o.vertexOffsetUpperRight),t.push(o.texFontSizeUpperRight),this._writeVV(t,l,a),t.push(n),t.push(i),t.push(s),t.push(o.vertexOffsetLowerLeft),t.push(o.texFontSizeLowerLeft),this._writeVV(t,l,a),t.push(n),t.push(i),t.push(s),t.push(o.vertexOffsetLowerRight),t.push(o.texFontSizeLowerRight),this._writeVV(t,l,a),r.push(4294967295),e.vertexCount+=4},t.prototype._writeVV=function(e,t,r){r.materialKeyInfo.hasVV()&&(e.push(t[a.VVType.SIZE]),e.push(t[a.VVType.COLOR]),e.push(t[a.VVType.OPACITY]),e.push(t[a.VVType.ROTATION]))},t.prototype._writeIndices=function(e,t,r){t.push(r+0),t.push(r+1),t.push(r+2),t.push(r+1),t.push(r+3),t.push(r+2),e.indexCount+=6},t}(d.default);t.default=b}.apply(null,i))||(e.exports=n)},1619:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1298),r(1541)],void 0===(n=function(e,t,r,i){function n(e,t){void 0===t&&(t=!1);var i=r.WGLVVFlag.SIZE_FIELD_STOPS|r.WGLVVFlag.SIZE_MINMAX_VALUE|r.WGLVVFlag.SIZE_SCALE_STOPS|r.WGLVVFlag.SIZE_UNIT_VALUE,n=(e&(r.WGLVVTarget.FIELD_TARGETS_OUTLINE|r.WGLVVTarget.MINMAX_TARGETS_OUTLINE|r.WGLVVTarget.SCALE_TARGETS_OUTLINE|r.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return t?i&n:i&~n}function s(e){var t=n(e,!1);return e&(r.WGLVVFlag.COLOR|r.WGLVVFlag.OPACITY|r.WGLVVFlag.ROTATION|t)}Object.defineProperty(t,"__esModule",{value:!0}),t.getVVFlags=function(e){if(!e)return r.WGLVVFlag.NONE;for(var t=0,n=0,s=e;n<s.length;n++){var o=s[n];if("size"===o.type){var a=i.getTypeOfSizeVisualVariable(o);t|=a,"outline"===o.target&&(t|=a<<4)}else"color"===o.type?t|=r.WGLVVFlag.COLOR:"opacity"===o.type?t|=r.WGLVVFlag.OPACITY:"rotation"===o.type&&(t|=r.WGLVVFlag.ROTATION)}return t},t.getSizeFlagsMask=n,t.getMarkerVVFlags=s,t.getFillVVFlags=function(e){return e&(r.WGLVVFlag.COLOR|r.WGLVVFlag.OPACITY)},t.getLineVVFlags=function(e,t){if(t)return e&n(e,!0);var i=n(e,!1);return e&(r.WGLVVFlag.COLOR|r.WGLVVFlag.OPACITY|i)},t.getTextVVFlags=function(e){return s(e)}}.apply(null,i))||(e.exports=n)},1634:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(8),r(7),r(68),r(415),r(1298),r(1501),r(1314),r(1541),r(1615),r(1719),r(1720),r(1724),r(1616),r(1617),r(1725),r(1456),r(1619),r(1544)],void 0===(n=function(e,t,r,i,n,s,o,a,l,u,p,h,c,d,f,g,v,_,m,y,x){Object.defineProperty(t,"__esModule",{value:!0});var b=n.getLogger("esri.views.2d.engine.webgl.WGLMeshFactory"),w={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:null,esriGeometryMultipoint:null,esriGeometryEnvelope:null},E=function(){function e(){this._materials=[],this._materialsIndex=new Map}return e.prototype.insert=function(e){var t=this._materials.length;return this._materials.push(e),t},e.prototype._hashGlyph=function(e,t,r){return"G-"+t+"-"+r+"-"+e.page},e.prototype._hashSprite=function(e,t,r){return"S-"+t+"-"+r+"-"+(e?e.page:-1)},e.prototype.createSpriteMaterial=function(e,t,r){var i=this._hashSprite(e,t,r);if(this._materialsIndex.has(i))return this._materialsIndex.get(i);var n=this._materials.length,s=l.default.fromSprite(e,t,r);return this._materials.push(s),this._materialsIndex.set(i,n),n},e.prototype.createGlyphMaterial=function(e,t,r){var i=this._hashGlyph(e,t,r);if(this._materialsIndex.has(i))return this._materialsIndex.get(i);var n=this._materials.length,s=l.default.fromGlyph(e,t,r);return this._materials.push(s),this._materialsIndex.set(i,n),n},e.prototype.get=function(e){return this._materials[e]},e.prototype.serialize=function(e){return m.serializeList(e,this._materials),e},e.deserialize=function(t){var r=new e;return r._materials=m.deserializeList(t,l.default),r},e}();t.MaterialStore=E;var S=function(){function e(e){this._bucketSize=e,this._rowsLength=o.TILE_SIZE/e,this._colsLength=o.TILE_SIZE/e,this._grid=this._initGrid()}return e.prototype.checkOverlap=function(e,t){var r=Math.floor(e/this._bucketSize),i=Math.floor(t/this._bucketSize);return r<0||r>=this._rowsLength||i<0||i>=this._colsLength||!!this._grid[i][r]||(this._grid[i][r]=!0,!1)},e.prototype.reset=function(){this._grid=this._initGrid()},e.prototype._initGrid=function(){for(var e=[],t=0;t<this._rowsLength;t++)e.push(new Array(this._colsLength));return e},e}();t.LabelGrid=S;var L=function(){function e(e,t,r){this.displayObjects=e,this.vertexVectorsMap=t,this._materials=r}return e.prototype.get=function(e){return this.vertexVectorsMap[e]},e.prototype.pushDisplayObject=function(e){this.displayObjects.push(e)},e.prototype.encode=function(e,t){var r=m.serializeList(new x.default(Uint32Array,this._guessSize()),this.displayObjects).buffer(),i=this._materials.serialize(new x.default(Uint32Array)).buffer(),n={};for(var s in t.push(r),t.push(i),this.vertexVectorsMap){var o=this.vertexVectorsMap[s];n[s]={},o.transfer(n[s],t)}e.displayObjects=r,e.materialStore=i,e.vertexBuffersMap=n,this.destroy()},e.prototype.destroy=function(){this.vertexVectorsMap=null,this.displayObjects=null},e.prototype._guessSize=function(){for(var e=this.displayObjects,t=Math.min(e.length,4),r=0,i=0;i<t;i++)r=Math.max(r,e[i].displayRecords.length);return 2*(12*e.length+e.length*r*40)},e}(),T=function(){function e(){this._vvMap=new Map}return e.prototype.set=function(e,t){this._vvMap.set(e,t)},e.prototype.getValue=function(e,t,r){return this._vvMap.has(e)?this._vvMap.get(e)(t,r):0},e}(),I=function(){function e(e,t,r,n,s,o,a,l,u,p){var h=this;this._labelsDebugTemplate=null,this._matcher=e,this._materials=r,this._geometryType=n,this._idField=s,this._pixelRatio=u,this._vvMap=null,this._vvFlags=a,this._vvBuf=new ArrayBuffer(16),this._vvBufU32=new Uint32Array(this._vvBuf),this._vvBufF32=new Float32Array(this._vvBuf),this._createVVFunctionMap(o,t,l),p&&(this._validateLabelingInfo(p)?this._labelTemplates=p.map(function(e){return f.default.fromText(h._materials,0,e.symbol,u,e.labelPlacement)}):b.error(new i("mapview-labeling:unsupported-geometry","LabelingInfo failed validation - unable to create labels for layer.")))}return e.from=function(t,r,n,s,o,a,l,u){switch(t.type){case"simple":return e._fromSimpleRenderer(t,r,n,s,o,a,l,u);case"unique-value":case"uniqueValue":return e._fromUniqueValueRenderer(t,r,n,s,o,a,l,u);case"class-breaks":case"classBreaks":return e._fromClassBreaksRenderer(t,r,n,s,o,a,l,u);default:return b.error(new i("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),null}},Object.defineProperty(e.prototype,"materials",{get:function(){return this._materials},enumerable:!0,configurable:!0}),e.prototype.createMeshData=function(e){var t=new Array(5),r=this._matcher.getDefault(),i=new Array,n=!!y.getMarkerVVFlags(this._vvFlags),s=!!y.getFillVVFlags(this._vvFlags),o=!!y.getLineVVFlags(this._vvFlags,"esriGeometryPolyline"!==this._geometryType),l=!!y.getTextVVFlags(this._vvFlags);return!this._labelTemplates&&r&&1===r.length&&r[0]instanceof v.default?(t[a.WGLGeometryType.MARKER]=new c.VertexVectors(a.WGLGeometryType.MARKER,n,e),t[a.WGLGeometryType.FILL]=new c.VertexVectors(a.WGLGeometryType.FILL,s,0),t[a.WGLGeometryType.LINE]=new c.VertexVectors(a.WGLGeometryType.LINE,o,0),t[a.WGLGeometryType.TEXT]=new c.VertexVectors(a.WGLGeometryType.TEXT,l,0),t[a.WGLGeometryType.LABEL]=new c.VertexVectors(a.WGLGeometryType.LABEL,!1,0)):(t[a.WGLGeometryType.MARKER]=new c.VertexVectors(a.WGLGeometryType.MARKER,n,e),t[a.WGLGeometryType.FILL]=new c.VertexVectors(a.WGLGeometryType.FILL,s,e),t[a.WGLGeometryType.LINE]=new c.VertexVectors(a.WGLGeometryType.LINE,o,e),t[a.WGLGeometryType.TEXT]=new c.VertexVectors(a.WGLGeometryType.TEXT,l,e),t[a.WGLGeometryType.LABEL]=new c.VertexVectors(a.WGLGeometryType.LABEL,!1,this._labelTemplates&&this._labelTemplates.length>0?e:0)),new L(i,t,this._materials)},e.prototype.write=function(e,t,r,i,n){var s=e,o=1===this._matcher.size()&&this._matcher.getDefault()||this._matcher.match(t,r),a=t.attributes[this._idField],l=new h(a),u=!!i&&!!this._labelTemplates&&i.has(a);if(this._computeVV(t,r),o&&(t.geometry||t.centroid)){for(var p=l.displayRecords,c=0,d=o;c<d.length;c++){var f=d[c],g=s.get(f.geometryType);f.writeMesh(p,g,this._geometryType,a,t,this._pixelRatio,this._vvBufU32)}if(u){var v=this._getLabelReference(o);this._writeLabelMesh(l,s,a,t,n,i.get(a),v)}s.pushDisplayObject(l)}},e.prototype._hasBadLabelClass=function(e,t){var r=e.labelPlacement,n=w[t];if(!n)return b.error(new i("mapview-labeling:unsupported-geometry-type","Unable to create labels for WebGL Feature Layer, "+t+" is not supported")),!0;if(!n.some(function(e){return e===r})){var s=n[0];r&&b.warn("Found invalid label placement type "+r+" for "+t+". Defaulting to "+s),e.labelPlacement=s}return!1},e.prototype._validateLabelingInfo=function(e){var t=this;return!e.some(function(e){return t._hasBadLabelClass(e,t._geometryType)})},e.prototype._getLabelReference=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(i instanceof v.default)return i}return null},e.prototype._writeLabelMesh=function(e,t,r,i,n,s,a){for(var l=e.displayRecords,u=0,p=0,h=-1,c=-1,d=0;d<s.labelingInfo.length;d++){var f=s.labelingInfo[d],g=s.text[d],v=this._labelTemplates[f],_=t.get(v.geometryType),m=n.get(v.symbolId).glyphMosaicItems,y=l.length;v.bindReferenceTemplate(a);var x=v.computeAnchor(this._geometryType,i);if(0===d&&(h=Math.floor(x[0]/o.COLLISION_BUCKET_SIZE),c=Math.floor(x[1]/o.COLLISION_BUCKET_SIZE)),!v.computeGlyphs(m,g)){var b=v.bounds;v.writeMesh(l,_,this._geometryType,r,i,this._pixelRatio,this._vvBufU32),e.anchor=x,e.addMetric(b,y,l.length-y,f);var w=b.center;u=Math.max(b.halfWidth+Math.abs(w[0]),u),p=Math.max(b.halfHeight+Math.abs(w[1]),p)}}if(e.metrics.length){var E=2.5*Math.max(u,p),S=E-e.anchor[0]%o.COLLISION_BUCKET_SIZE,L=E-e.anchor[1]%o.COLLISION_BUCKET_SIZE,T=Math.ceil(Math.abs(S/o.COLLISION_BUCKET_SIZE)),I=Math.ceil(Math.abs(L/o.COLLISION_BUCKET_SIZE));e.xBucket=h,e.yBucket=c,e.xOverflow=T,e.yOverflow=I}},e.prototype._debugLabels=function(e,t,r,i,n){var s=i[0]+n.center[0],o=i[1]+n.center[1],a={geometry:{paths:[[[s-n.width/2,o+n.height/2],[0,-n.height],[n.width,0],[0,n.height],[-n.width,0]]]},attributes:{}},l=this._getLabelDebugTemplate(),u=t.get(l.geometryType);l.writeMesh(e,u,"esriGeometryPolyline",r,a,this._pixelRatio,this._vvBufU32)},e.prototype._getLabelDebugTemplate=function(){return this._labelsDebugTemplate||(this._labelsDebugTemplate=this._createLabelsDebugTemplate()),this._labelsDebugTemplate},e.prototype._createLabelsDebugTemplate=function(){var e=new s({style:"solid",width:1,color:[255,0,0,1]});return g.default.fromSimpleLine(this._materials,0,e,null,this._pixelRatio)},e.prototype._isErrorVV=function(e){return null===e||isNaN(e)||e===1/0},e.prototype._computeVV=function(e,t){if(!this._vvMap)return 0;var r=this._vvMap.getValue(a.VVType.SIZE,e,t),i=this._vvMap.getValue(a.VVType.COLOR,e,t),n=this._vvMap.getValue(a.VVType.OPACITY,e,t),s=this._vvMap.getValue(a.VVType.ROTATION,e,t);return this._vvBufF32[a.VVType.SIZE]=this._isErrorVV(r)?NaN:r,this._vvBufF32[a.VVType.COLOR]=this._isErrorVV(i)?NaN:i,this._vvBufF32[a.VVType.OPACITY]=this._isErrorVV(n)?NaN:n,this._vvBufF32[a.VVType.ROTATION]=this._isErrorVV(s)?NaN:s,0},e.prototype._createVVFunctionMap=function(e,t,r){if(e&&e.length)for(var i=0,n=e;i<n.length;i++){var s=n[i],o=u.getVVType(s.type),a=this._createGetValueFunction(s,t,r);a&&(this._vvMap||(this._vvMap=new T),this._vvMap.set(o,a))}},e.prototype._createGetValueFunction=function(e,t,r){if(u.getVVType(e.type)===a.VVType.SIZE){var i=e,n=p.getTypeOfSizeVisualVariable(i);if(n===a.WGLVVFlag.SIZE_SCALE_STOPS)return null;var s=n===a.WGLVVFlag.SIZE_UNIT_VALUE&&function(e){return p.getVisualVariableSizeValueRepresentationRatio(e,i.valueRepresentation)};return this._createNormalizedFunction(e,t,r,s)}return this._createNormalizedFunction(e,t,r)},e.prototype._createNormalizedFunction=function(e,t,r,n){var s=e.field;if(s){if("string"==typeof s){var o=e.normalizationField;return o?function(e){if(e.attributes[s]&&e.attributes[o]){var t=e.attributes[s]/e.attributes[o];return n?n(t):t}}:n?function(e){return n(e.attributes[s])}:function(e){return e.attributes[s]}}return"function"==typeof s?(b.error(new i("mapview-rendering:unsupported-feature","Function field types are not currently supported. Please use a valueExpression instead")),function(e){}):(b.error(new i("mapview-rendering:invalid-type","The field for a vv must be a string or a number, but got "+typeof s)),function(e){})}if(e.valueExpression&&"$view.scale"!==e.valueExpression){var a={valueExpression:e.valueExpression,spatialReference:r,layer:t};return u.createArcadeFunction(a,n)}return b.error("Unable to create a normalized function for visual variable: "+e),function(e){}},e._fromSimpleRenderer=function(t,r,i,n,s,o,a,l){var u=t.getSymbols(),p=t.visualVariables,h=y.getVVFlags(p),c=new _.default,f=new E;if(u.length){var g=u[0];c.setDefault(d.createMeshTemplates([],f,g,i,h,a))}return new e(c,r,f,n,s,p,h,o,a,l)},e._fromUniqueValueRenderer=function(t,r,i,n,s,o,a,l){var u=t.uniqueValueInfos,p=t.visualVariables,h=y.getVVFlags(p),c=[t.field];t.field2&&c.push(t.field2),t.field3&&c.push(t.field3);for(var f=t.valueExpression,g=f?{valueExpression:f,spatialReference:o,layer:r}:null,v=new _.MapMatcher(c,t.fieldDelimiter,g),m=new E,x=t.backgroundFillSymbol,b=x&&d.createMeshTemplates([],m,x,i,h,a),w=0,S=u;w<S.length;w++){var L=S[w],T=d.createMeshTemplates([],m,L.symbol,i,h,a);v.add(L.value,b?b.concat(T):T)}var I=t.defaultSymbol;if(I){var V=d.createMeshTemplates([],m,I,i,h,a);v.setDefault(b?b.concat(V):V)}return new e(v,r,m,n,s,p,h,o,a,l)},e._fromClassBreaksRenderer=function(t,r,i,n,s,o,a,l){for(var u=t.isMaxInclusive,p=t.visualVariables,h=t.valueExpression,c=t.normalizationField,f=t.normalizationTotal,g=t.normalizationType,v=y.getVVFlags(p),m=t.field,x=h?{valueExpression:h,spatialReference:o,layer:r}:null,b={normalizationField:c,normalizationTotal:f,normalizationType:g},w=new _.IntervalMatcher(m,u,x,b),S=new E,L=t.backgroundFillSymbol,T=L&&d.createMeshTemplates([],S,L,i,v,a,!0),I=0,V=t.classBreakInfos;I<V.length;I++){var N=V[I],G=N.symbol,O=d.createMeshTemplates([],S,G,i,v,a),C={min:N.minValue,max:N.maxValue};w.add(C,T?T.concat(O):O)}var R=t.defaultSymbol;if(R){var U=d.createMeshTemplates([],S,R,i,v,a);w.setDefault(T?T.concat(U):U)}return new e(w,r,S,n,s,p,v,o,a,l)},e}();t.default=I}.apply(null,i))||(e.exports=n)},1635:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1559)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=new r;t.bidiText=function(e){return i.hasBidiChar(e)?(t="rtl"===i.checkContextual(e)?"IDNNN":"ICNNN",[i.bidiTransform(e,t,"VLYSN"),!0]):[e,!1];var t}}.apply(null,i))||(e.exports=n)},1636:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=8,i=-3;t.getFullyQualifiedFontName=function(e){var t=function(e){if(!e.weight)return"";switch(e.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}(e)+function(e){if(!e.style)return"";switch(e.style.toLowerCase()){case"italic":case"oblic":return"-italic"}return""}(e);return function(e){var t=e.toLowerCase().split(" ").join("-");switch(t){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return t}}(e.family)+(t.length>0?t:"-regular")},t.getFontDecorationOffset=function(e){switch(e.decoration.toLowerCase()){case"underline":return r;case"line-through":return i}return NaN}}.apply(null,i))||(e.exports=n)},1715:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1460)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._pool=[],this._set=new r.default}return e.prototype.acquire=function(){if(0===this._pool.length)return new r.default;var e=this._pool.pop();return this._set.delete(e),e},e.prototype.release=function(e){e&&!this._set.has(e)&&(e.clear(),this._pool.length<5e4&&(this._pool.push(e),this._set.add(e)))},e.acquire=function(){return n.acquire()},e.release=function(e){return n.release(e)},e}();t.default=i;var n=new i}.apply(null,i))||(e.exports=n)},1716:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(4),r(1472),r(1),r(1356)],void 0===(n=function(e,t,r,i,n,s,o,a){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])},t.prototype.destroy=function(){},Object.defineProperty(t.prototype,"supportsTileUpdates",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spatialReference",{get:function(){var e=this.get("tileStore.spatialReference");return e&&e.toJSON()||null},enumerable:!0,configurable:!0}),i([o.property({readOnly:!0})],t.prototype,"supportsTileUpdates",null),i([o.property({constructOnly:!0})],t.prototype,"remoteClient",void 0),i([o.property({constructOnly:!0})],t.prototype,"service",void 0),i([o.property({dependsOn:["tileStore.spatialReference"]})],t.prototype,"spatialReference",null),i([o.property({constructOnly:!0})],t.prototype,"tileStore",void 0),i([o.subclass()],t)}(o.declared(n,s,a.default));t.default=l}.apply(null,i))||(e.exports=n)},1717:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(){this.vertexData=new Map,this.vertexCount=0,this.indexData=[]}return e.prototype.clear=function(){this.vertexData.clear(),this.vertexCount=0,this.indexData=[]},e.prototype.update=function(e,t,r){for(var i in e)this.vertexData.set(i,e[i]);for(var i in this.vertexData)null===e[i]&&this.vertexData.delete(i);this.vertexCount=t,this.indexData=r},e}()}.apply(null,i))||(e.exports=n)},1718:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1531)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,r,i,n){void 0===i&&(i=255),void 0===n&&(n=0),this.bounds=e,this.range=t,this.index=r,this.minZoom=i,this.maxZoom=n}return e.prototype.serialize=function(e){return this.bounds.serialize(e),e.writeInt32(this.range.from),e.writeInt32(this.range.count),e.writeInt32(this.index),e},e.deserialize=function(t){return new e(r.default.deserialize(t),{from:t.readInt32(),count:t.readInt32()},t.readInt32())},e}();t.default=i}.apply(null,i))||(e.exports=n)},1719:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1314),r(1544)],void 0===(n=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.data=e,this.stride=t,this.vertexCount=0}return e.prototype.transfer=function(e,t){var r=this.data.buffer();e.vertexCount=this.vertexCount,e.data=r,e.stride=this.stride,t.push(r)},e}();t.default=n;var s=function(){function e(e,t,s){this.geometryType=e,this.indexVector=new i.default(Uint32Array,s),this.namedVectors={};var o=r.getStrides(e,t);for(var a in o){var l=o[a],u=l/4,p=new i.default(Uint32Array,u*s);this.namedVectors[a]=new n(p,l)}}return e.prototype.get=function(e){return this.namedVectors[e].data},e.prototype.transfer=function(e,t){var r=this.indexVector.buffer(),i={};for(var n in t.push(r),this.namedVectors){var s=this.namedVectors[n];i[n]={},s.transfer(i[n],t)}e.geometryType=this.geometryType,e.indexBuffer=r,e.namedBuffers=i,this.destroy()},e.prototype.destroy=function(){this.indexVector=null,this.namedVectors=null},e}();t.VertexVectors=s}.apply(null,i))||(e.exports=n)},1720:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(1298),r(1721),r(1616),r(1617),r(1618),r(1619)],void 0===(n=function(e,t,r,i,n,s,o,a,l){Object.defineProperty(t,"__esModule",{value:!0});var u=r.getLogger("esri.views.2d.engine.webgl.mesh.templates.meshTemplateUtils");t.createMeshTemplates=function(e,t,r,p,h,c,d){if(void 0===d&&(d=!1),-1!==r.type.indexOf("3d"))return u.error("3D symbols are not supported with MapView"),e;var f=p.get(r.id);switch(f||u.error("Couldn't find texture resources for symbol: "+r.id+"!"),r.type){case i.EsriSymbolTypeKebab.SIMPLE_MARKER:return e.push(o.default.fromSimpleMarker(t,l.getMarkerVVFlags(h),r,f.spriteMosaicItem,c)),e;case i.EsriSymbolTypeKebab.PICTURE_MARKER:return e.push(o.default.fromPictureMarker(t,l.getMarkerVVFlags(h),r,f.spriteMosaicItem,c)),e;case i.EsriSymbolTypeKebab.SIMPLE_FILL:var g=r;if(e.push(n.default.fromSimpleFill(t,l.getFillVVFlags(h),g,f.spriteMosaicItem,c,d)),g.outline){var v=p.get(g.outline.id);e.push(s.default.fromSimpleLine(t,l.getLineVVFlags(h,!0),g.outline,v&&v.spriteMosaicItem,c))}return e;case i.EsriSymbolTypeKebab.PICTURE_FILL:var _=r;return e.push(n.default.fromPictureFill(t,l.getFillVVFlags(h),_,f.spriteMosaicItem,c,d)),_.outline&&(v=p.get(_.outline.id),e.push(s.default.fromSimpleLine(t,l.getLineVVFlags(h,!0),_.outline,v&&v.spriteMosaicItem,c))),e;case i.EsriSymbolTypeKebab.SIMPLE_LINE:return e.push(s.default.fromSimpleLine(t,l.getLineVVFlags(h,!1),r,f.spriteMosaicItem,c)),e;case i.EsriSymbolTypeKebab.TEXT:return e.push(a.default.fromText(t,l.getTextVVFlags(h),r,c,f.glyphMosaicItems)),e;default:return u.error("Unable to create mesh template for unknown symbol type: "+r.type),e}}}.apply(null,i))||(e.exports=n)},1721:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(9),r(7),r(424),r(1431),r(415),r(1298),r(1298),r(1435),r(1538),r(1440),r(1722),r(1473)],void 0===(n=function(e,t,r,i,n,s,o,a,l,u,p,h,c,d,f){Object.defineProperty(t,"__esModule",{value:!0});var g=n.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLFillTemplate"),v=[],_=[],m=function(e){function t(t,r,n,s,o,a,u,p){var c=e.call(this)||this;c.fillColor=s,c.tl=o,c.br=a,c.aux=u,c.isBFS=p,c.geometryType=l.WGLGeometryType.FILL,c.useLibtess=!1;var f=i("esri-featurelayer-webgl");return c.useLibtess="libtess"===((f||{}).tesselator||"libtess"),c.useLibtess&&(c._tesselator=new d.default),c.vvFlags=r,c._materialStore=t,c.materialId=c._materialStore.createSpriteMaterial(n,c.geometryType,r),c._tileClipper=new h.TileClipper(0,0,0,1,8),c._tileClipper.setExtent(512),c}return r(t,e),t.fromSimpleFill=function(e,r,i,n,s,a){void 0===a&&(a=!1);var l=i.color,u=l&&"none"!==i.style&&o.premultiplyAlphaRGBA(l)||0;if(!n)return new t(e,r,null,u,0,0,0,a);var h=n.rect,c=n.width,d=n.height,f=h.x+1,g=h.y+1,v=h.x+1+c,_=h.y+1+d;return new t(e,r,n,u,p.i1616to32(f,g),p.i1616to32(v,_),p.i8888to32(p.nextHighestPowerOfTwo(v-f),p.nextHighestPowerOfTwo(_-g),0,0),a)},t.fromPictureFill=function(e,r,i,n,s,o){void 0===o&&(o=!1);var l=a.PICTURE_FILL_COLOR,u=n.rect,h=n.width,c=n.height,d=u.x+1,f=u.y+1,g=u.x+1+h,v=u.y+1+c;return new t(e,r,n,l,p.i1616to32(d,f),p.i1616to32(g,v),p.i8888to32(p.nextHighestPowerOfTwo(i.width),p.nextHighestPowerOfTwo(i.height),0,0),o)},t.prototype.writeMesh=function(e,t,r,i,n,s,o){if(v.length=0,this.vvFlags&u.WGLVVFlag.COLOR||0!==this.fillColor){if("esriGeometryPolygon"!==r)return void g.error("Unable to handle geometryType: "+r);var a=n.geometry,l=this._isClippingRequired(a),p=l?this._clip(a,!this.useLibtess):a.rings;return this.useLibtess?this._writeMeshLibtess(e,t,r,i,p,l,s,o):this._writeMeshEarcut(e,t,r,i,p,l,s,o)}},t.prototype._isClippingRequired=function(e){for(var t=0,r=e.rings;t<r.length;t++){var i=r[t],n=i.length;if(!(n<3)){var s=i[0][0],o=i[0][1];if(s<-8||s>520||o<-8||o>520)return!0;for(var a=1;a<n;++a)if(s+=i[a][0],o+=i[a][1],s<-8||s>520||o<-8||o>520)return!0}}return!1},t.prototype._clip=function(e,t){var r,i;this._tileClipper.reset(3);for(var n=0,s=e.rings;n<s.length;n++){var o=s[n],a=o.length;if(!(a<3)){r=o[0][0],i=o[0][1],this._tileClipper.moveTo(r,i);for(var l=1;l<a;++l)r+=o[l][0],i+=o[l][1],this._tileClipper.lineTo(r,i);this._tileClipper.close()}}return this._tileClipper.result(t)},t.prototype._writeMeshLibtess=function(e,t,r,i,n,s,o,a){if(n&&n.length){var l=this._materialStore.get(this.materialId),u=[],p=t.indexVector,h=t.get("geometry"),d=new c(i,this.geometryType,this.materialId),f=this._getOffset(h,l),g=s;d.vertexFrom=f,d.indexFrom=p.length,e.push(d),this._tesselator.beginPolygon(v,u);for(var _=0,m=n;_<m.length;_++){var y=m[_];if(!(y.length<3)){this._tesselator.beginContour();var x=void 0,b=void 0;g?(x=y[0].x,b=y[0].y):(x=y[0][0],b=y[0][1]);var w=[x,b,0];this._tesselator.addVertex(w,w);for(var E=1;E<y.length-1;E++){g?(x=y[E].x,b=y[E].y):(x+=y[E][0],b+=y[E][1]);var S=[x,b,0];this._tesselator.addVertex(S,S)}this._tesselator.endContour()}}this._tesselator.endPolygon(),this._writeVerticesLibTess(d,h,i,v,l,a),this._writeIndicesLibTess(d,p,f,u)}},t.prototype._writeMeshEarcut=function(e,t,r,i,n,s,o,a){if(n&&n.length){var l=this._materialStore.get(this.materialId),u=t.indexVector,p=t.get("geometry"),h=new c(i,this.geometryType,this.materialId),d=this._getOffset(p,l);h.vertexFrom=d,h.indexFrom=u.length,e.push(h);for(var f=0,g=0,m=s,y=0,x=n;y<x.length;y++){var b=x[y],w=g,E=void 0,S=void 0;m?(E=b[0].x,S=b[0].y):(E=b[0][0],S=b[0][1]),v[g++]=E,v[g++]=S;for(var L=0,T=1;T<b.length;++T){var I=void 0,V=void 0;if(m){var N=E,G=S;I=(E=b[T].x)-N,V=(S=b[T].y)-G}else E+=I=b[T][0],S+=V=b[T][1];L-=I*(S+S+V),v[g++]=E,v[g++]=S}L>0?(w-f>0&&(this._write(h,u,p,d,i,v,_,f,w,l,a),f=w),_.length=0):L<0&&w-f>0?_.push(.5*(w-f)):g=w}g-f>0&&this._write(h,u,p,d,i,v,_,f,g,l,a),v.length=_.length=0}},t.prototype._write=function(e,t,r,i,n,o,a,l,u,p,h){var c=s(o.slice(l,u),a,2);if(c.length){var d=this._getOffset(r,p);this._writeVertices(e,r,n,o,a,p,h),this._writeIndices(e,t,d,c)}},t.prototype._getOffset=function(e,t){var r=t.materialKeyInfo.hasVV()?8:6;return e.length/r},t.prototype._writeVertices=function(e,t,r,i,n,s,o){for(var a=0;a<i.length;a+=2){var l=p.i1616to32(i[a],i[a+1]);t.push(l),t.push(r),t.push(this.fillColor),t.push(this.tl),t.push(this.br),t.push(this.aux),this._writeVV(t,o,s),e.vertexCount++}},t.prototype._writeIndices=function(e,t,r,i){for(var n=r,s=0;s<i.length;s+=3)t.push(n+i[s]),t.push(n+i[s+1]),t.push(n+i[s+2]),e.indexCount+=3},t.prototype._writeVerticesLibTess=function(e,t,r,i,n,s){for(var o=0;o<i.length;o+=2){var a=p.i1616to32(i[o],i[o+1]);t.push(a),t.push(r),t.push(this.fillColor),t.push(this.tl),t.push(this.br),t.push(this.aux),this._writeVV(t,s,n),e.vertexCount++}},t.prototype._writeIndicesLibTess=function(e,t,r,i){for(var n=r,s=0;s<i.length;s++)t.push(n+i[s]),e.indexCount++},t.prototype._writeVV=function(e,t,r){r.materialKeyInfo.hasVV()&&(this.isBFS?(e.push(4294967295),e.push(4294967295)):(e.push(t[l.VVType.COLOR]),e.push(t[l.VVType.OPACITY])))},t}(f.default);t.default=m}.apply(null,i))||(e.exports=n)},1722:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(1723)],void 0===(n=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=r.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator"),s=function(){function e(){this._currentVertexIndex=0,this._indexCounter=0,this._triangleIndices=[-1,-1,-1],this.glu=new i.GluTesselator,this.glu.gluTessCallback(i.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this)),this.glu.gluTessCallback(i.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this)),this.glu.gluTessCallback(i.gluEnum.GLU_TESS_END,this._endcallback.bind(this)),this.glu.gluTessCallback(i.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this)),this.glu.gluTessCallback(i.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this)),this.glu.gluTessCallback(i.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this)),this.glu.gluTessProperty(i.gluEnum.GLU_TESS_WINDING_RULE,i.windingRule.GLU_TESS_WINDING_ODD)}return e.prototype.beginPolygon=function(e,t){this._triangleIndices[0]=-1,this._triangleIndices[1]=-1,this._triangleIndices[2]=-1,this._currentVertexIndex=0,this._indexCounter=0,this.glu.gluTessBeginPolygon(e),this._indices=t},e.prototype.endPolygon=function(){this.glu.gluTessEndPolygon()},e.prototype.beginContour=function(){this.glu.gluTessBeginContour()},e.prototype.endContour=function(){this.glu.gluTessEndContour()},e.prototype.addVertex=function(e,t){this.glu.gluTessVertex(e,t)},e.prototype._vertexCallback=function(e,t){if(t[t.length]=e[0],t[t.length]=e[1],this._triangleIndices[this._currentVertexIndex]=-1,this._currentVertexIndex>=2){for(var r=0;r<3;r++)-1===this._triangleIndices[r]&&(this._triangleIndices[r]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[r];this._currentVertexIndex=0}else this._currentVertexIndex++},e.prototype._begincallback=function(e){this._triangleIndices[0]=-1,this._triangleIndices[1]=-1,this._triangleIndices[2]=-1,this._currentVertexIndex=0},e.prototype._endcallback=function(){this._currentVertexIndex=0},e.prototype._errorcallback=function(e){n.error("Encountered error during tesselation: "+e)},e.prototype._combinecallback=function(e,t,r){return[e[0],e[1],e[2]]},e.prototype._edgeCallback=function(e){},e}();t.default=s}.apply(null,i))||(e.exports=n)},1723:function(e,t,r){var i;
/**
   * @license
   * Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
   * Copyright 2015, Google Inc. All Rights Reserved.
   *
   * Permission is hereby granted, free of charge, to any person obtaining a copy
   * of this software and associated documentation files (the "Software"), to
   * deal in the Software without restriction, including without limitation the
   * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
   * sell copies of the Software, and to permit persons to whom the Software is
   * furnished to do so, subject to the following conditions:
   *
   * The above copyright notice including the dates of first publication and
   * either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
   * shall be included in all copies or substantial portions of the Software.
   *
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
   * SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
   * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
   * IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
   *
   * Original Code. The Original Code is: OpenGL Sample Implementation,
   * Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
   * Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
   * Copyright in any portions created by third parties is as indicated
   * elsewhere herein. All Rights Reserved.
   */void 0===(i=function(){"use strict";var e={DEBUG:!1,assert:function(t,r){if(e.DEBUG&&!t)throw new Error("Assertion failed"+(r?": "+r:""))},GLU_TESS_MAX_COORD:1e150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901}};return e.PQHandle,e.geom={},e.geom.vertEq=function(e,t){return e.s===t.s&&e.t===t.t},e.geom.vertLeq=function(e,t){return e.s<t.s||e.s===t.s&&e.t<=t.t},e.geom.edgeEval=function(t,r,i){e.assert(e.geom.vertLeq(t,r)&&e.geom.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?n<s?r.t-t.t+(t.t-i.t)*(n/(n+s)):r.t-i.t+(i.t-t.t)*(s/(n+s)):0},e.geom.edgeSign=function(t,r,i){e.assert(e.geom.vertLeq(t,r)&&e.geom.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?(r.t-i.t)*n+(r.t-t.t)*s:0},e.geom.transLeq=function(e,t){return e.t<t.t||e.t===t.t&&e.s<=t.s},e.geom.transEval=function(t,r,i){e.assert(e.geom.transLeq(t,r)&&e.geom.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?n<s?r.s-t.s+(t.s-i.s)*(n/(n+s)):r.s-i.s+(i.s-t.s)*(s/(n+s)):0},e.geom.transSign=function(t,r,i){e.assert(e.geom.transLeq(t,r)&&e.geom.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?(r.s-i.s)*n+(r.s-t.s)*s:0},e.geom.edgeGoesLeft=function(t){return e.geom.vertLeq(t.dst(),t.org)},e.geom.edgeGoesRight=function(t){return e.geom.vertLeq(t.org,t.dst())},e.geom.vertL1dist=function(e,t){return Math.abs(e.s-t.s)+Math.abs(e.t-t.t)},e.geom.vertCCW=function(e,t,r){return e.s*(t.t-r.t)+t.s*(r.t-e.t)+r.s*(e.t-t.t)>=0},e.geom.interpolate_=function(e,t,r,i){return(e=e<0?0:e)<=(r=r<0?0:r)?0===r?(t+i)/2:t+e/(e+r)*(i-t):i+r/(e+r)*(t-i)},e.geom.edgeIntersect=function(t,r,i,n,s){var o,a,l;e.geom.vertLeq(t,r)||(l=t,t=r,r=l),e.geom.vertLeq(i,n)||(l=i,i=n,n=l),e.geom.vertLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.geom.vertLeq(i,r)?e.geom.vertLeq(r,n)?((o=e.geom.edgeEval(t,i,r))+(a=e.geom.edgeEval(i,r,n))<0&&(o=-o,a=-a),s.s=e.geom.interpolate_(o,i.s,a,r.s)):((o=e.geom.edgeSign(t,i,r))+(a=-e.geom.edgeSign(t,n,r))<0&&(o=-o,a=-a),s.s=e.geom.interpolate_(o,i.s,a,n.s)):s.s=(i.s+r.s)/2,e.geom.transLeq(t,r)||(l=t,t=r,r=l),e.geom.transLeq(i,n)||(l=i,i=n,n=l),e.geom.transLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.geom.transLeq(i,r)?e.geom.transLeq(r,n)?((o=e.geom.transEval(t,i,r))+(a=e.geom.transEval(i,r,n))<0&&(o=-o,a=-a),s.t=e.geom.interpolate_(o,i.t,a,r.t)):((o=e.geom.transSign(t,i,r))+(a=-e.geom.transSign(t,n,r))<0&&(o=-o,a=-a),s.t=e.geom.interpolate_(o,i.t,a,n.t)):s.t=(i.t+r.t)/2},e.mesh={},e.mesh.makeEdge=function(t){var r=e.mesh.makeEdgePair_(t.eHead);return e.mesh.makeVertex_(r,t.vHead),e.mesh.makeVertex_(r.sym,t.vHead),e.mesh.makeFace_(r,t.fHead),r},e.mesh.meshSplice=function(t,r){var i=!1,n=!1;t!==r&&(r.org!==t.org&&(n=!0,e.mesh.killVertex_(r.org,t.org)),r.lFace!==t.lFace&&(i=!0,e.mesh.killFace_(r.lFace,t.lFace)),e.mesh.splice_(r,t),n||(e.mesh.makeVertex_(r,t.org),t.org.anEdge=t),i||(e.mesh.makeFace_(r,t.lFace),t.lFace.anEdge=t))},e.mesh.deleteEdge=function(t){var r=t.sym,i=!1;t.lFace!==t.rFace()&&(i=!0,e.mesh.killFace_(t.lFace,t.rFace())),t.oNext===t?e.mesh.killVertex_(t.org,null):(t.rFace().anEdge=t.oPrev(),t.org.anEdge=t.oNext,e.mesh.splice_(t,t.oPrev()),i||e.mesh.makeFace_(t,t.lFace)),r.oNext===r?(e.mesh.killVertex_(r.org,null),e.mesh.killFace_(r.lFace,null)):(t.lFace.anEdge=r.oPrev(),r.org.anEdge=r.oNext,e.mesh.splice_(r,r.oPrev())),e.mesh.killEdge_(t)},e.mesh.addEdgeVertex=function(t){var r=e.mesh.makeEdgePair_(t),i=r.sym;return e.mesh.splice_(r,t.lNext),r.org=t.dst(),e.mesh.makeVertex_(i,r.org),r.lFace=i.lFace=t.lFace,r},e.mesh.splitEdge=function(t){var r=e.mesh.addEdgeVertex(t).sym;return e.mesh.splice_(t.sym,t.sym.oPrev()),e.mesh.splice_(t.sym,r),t.sym.org=r.org,r.dst().anEdge=r.sym,r.sym.lFace=t.rFace(),r.winding=t.winding,r.sym.winding=t.sym.winding,r},e.mesh.connect=function(t,r){var i=!1,n=e.mesh.makeEdgePair_(t),s=n.sym;return r.lFace!==t.lFace&&(i=!0,e.mesh.killFace_(r.lFace,t.lFace)),e.mesh.splice_(n,t.lNext),e.mesh.splice_(s,r),n.org=t.dst(),s.org=r.org,n.lFace=s.lFace=t.lFace,t.lFace.anEdge=s,i||e.mesh.makeFace_(n,t.lFace),n},e.mesh.zapFace=function(t){var r,i=t.anEdge,n=i.lNext;do{if(n=(r=n).lNext,r.lFace=null,null===r.rFace()){r.oNext===r?e.mesh.killVertex_(r.org,null):(r.org.anEdge=r.oNext,e.mesh.splice_(r,r.oPrev()));var s=r.sym;s.oNext===s?e.mesh.killVertex_(s.org,null):(s.org.anEdge=s.oNext,e.mesh.splice_(s,s.oPrev())),e.mesh.killEdge_(r)}}while(r!==i);var o=t.prev,a=t.next;a.prev=o,o.next=a},e.mesh.meshUnion=function(e,t){var r=e.fHead,i=e.vHead,n=e.eHead,s=t.fHead,o=t.vHead,a=t.eHead;return s.next!==s&&(r.prev.next=s.next,s.next.prev=r.prev,s.prev.next=r,r.prev=s.prev),o.next!==o&&(i.prev.next=o.next,o.next.prev=i.prev,o.prev.next=i,i.prev=o.prev),a.next!==a&&(n.sym.next.sym.next=a.next,a.next.sym.next=n.sym.next,a.sym.next.sym.next=n,n.sym.next=a.sym.next),e},e.mesh.deleteMesh=function(e){},e.mesh.makeEdgePair_=function(t){var r=new e.GluHalfEdge,i=new e.GluHalfEdge,n=t.sym.next;return i.next=n,n.sym.next=r,r.next=t,t.sym.next=i,r.sym=i,r.oNext=r,r.lNext=i,i.sym=r,i.oNext=i,i.lNext=r,r},e.mesh.splice_=function(e,t){var r=e.oNext,i=t.oNext;r.sym.lNext=t,i.sym.lNext=e,e.oNext=i,t.oNext=r},e.mesh.makeVertex_=function(t,r){var i=r.prev,n=new e.GluVertex(r,i);i.next=n,r.prev=n,n.anEdge=t;var s=t;do{s.org=n,s=s.oNext}while(s!==t)},e.mesh.makeFace_=function(t,r){var i=r.prev,n=new e.GluFace(r,i);i.next=n,r.prev=n,n.anEdge=t,n.inside=r.inside;var s=t;do{s.lFace=n,s=s.lNext}while(s!==t)},e.mesh.killEdge_=function(e){var t=e.next,r=e.sym.next;t.sym.next=r,r.sym.next=t},e.mesh.killVertex_=function(e,t){var r=e.anEdge,i=r;do{i.org=t,i=i.oNext}while(i!==r);var n=e.prev,s=e.next;s.prev=n,n.next=s},e.mesh.killFace_=function(e,t){var r=e.anEdge,i=r;do{i.lFace=t,i=i.lNext}while(i!==r);var n=e.prev,s=e.next;s.prev=n,n.next=s},e.normal={},e.normal.S_UNIT_X_=1,e.normal.S_UNIT_Y_=0,e.normal.projectPolygon=function(t,r,i,n){var s=!1,o=[r,i,n];0===r&&0===i&&0===n&&(e.normal.computeNormal_(t,o),s=!0);var a,l=e.normal.longAxis_(o),u=t.mesh.vHead;if(e.TRUE_PROJECT){e.normal.normalize_(o);var p=[0,0,0],h=[0,0,0];p[l]=0,p[(l+1)%3]=e.normal.S_UNIT_X_,p[(l+2)%3]=e.normal.S_UNIT_Y_;var c=e.normal.dot_(p,o);for(p[0]-=c*o[0],p[1]-=c*o[1],p[2]-=c*o[2],e.normal.normalize_(p),h[0]=o[1]*p[2]-o[2]*p[1],h[1]=o[2]*p[0]-o[0]*p[2],h[2]=o[0]*p[1]-o[1]*p[0],e.normal.normalize_(h),a=u.next;a!==u;a=a.next)a.s=e.normal.dot_(a.coords,p),a.t=e.normal.dot_(a.coords,h)}else{var d=(l+1)%3,f=(l+2)%3,g=o[l]>0?1:-1;for(a=u.next;a!==u;a=a.next)a.s=a.coords[d],a.t=g*a.coords[f]}s&&e.normal.checkOrientation_(t)},e.normal.dot_=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.normal.normalize_=function(t){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];e.assert(r>0),r=Math.sqrt(r),t[0]/=r,t[1]/=r,t[2]/=r},e.normal.longAxis_=function(e){var t=0;return Math.abs(e[1])>Math.abs(e[0])&&(t=1),Math.abs(e[2])>Math.abs(e[t])&&(t=2),t},e.normal.computeNormal_=function(t,r){var i,n=[-2*e.GLU_TESS_MAX_COORD,-2*e.GLU_TESS_MAX_COORD,-2*e.GLU_TESS_MAX_COORD],s=[2*e.GLU_TESS_MAX_COORD,2*e.GLU_TESS_MAX_COORD,2*e.GLU_TESS_MAX_COORD],o=[],a=[],l=t.mesh.vHead;for(i=l.next;i!==l;i=i.next)for(var u=0;u<3;++u){var p=i.coords[u];p<s[u]&&(s[u]=p,a[u]=i),p>n[u]&&(n[u]=p,o[u]=i)}var h=0;if(n[1]-s[1]>n[0]-s[0]&&(h=1),n[2]-s[2]>n[h]-s[h]&&(h=2),s[h]>=n[h])return r[0]=0,r[1]=0,void(r[2]=1);var c=0,d=a[h],f=o[h],g=[0,0,0],v=[d.coords[0]-f.coords[0],d.coords[1]-f.coords[1],d.coords[2]-f.coords[2]],_=[0,0,0];for(i=l.next;i!==l;i=i.next){_[0]=i.coords[0]-f.coords[0],_[1]=i.coords[1]-f.coords[1],_[2]=i.coords[2]-f.coords[2],g[0]=v[1]*_[2]-v[2]*_[1],g[1]=v[2]*_[0]-v[0]*_[2],g[2]=v[0]*_[1]-v[1]*_[0];var m=g[0]*g[0]+g[1]*g[1]+g[2]*g[2];m>c&&(c=m,r[0]=g[0],r[1]=g[1],r[2]=g[2])}c<=0&&(r[0]=r[1]=r[2]=0,r[e.normal.longAxis_(v)]=1)},e.normal.checkOrientation_=function(e){for(var t=0,r=e.mesh.fHead,i=r.next;i!==r;i=i.next){var n=i.anEdge;if(!(n.winding<=0))do{t+=(n.org.s-n.dst().s)*(n.org.t+n.dst().t),n=n.lNext}while(n!==i.anEdge)}if(t<0)for(var s=e.mesh.vHead,o=s.next;o!==s;o=o.next)o.t=-o.t},e.render={},e.render.renderMesh=function(t,r,i){for(var n=!1,s=-1,o=r.fHead.prev;o!==r.fHead;o=o.prev)if(o.inside){n||(t.callBeginCallback(e.primitiveType.GL_TRIANGLES),n=!0);var a=o.anEdge;e.assert(a.lNext.lNext.lNext===a,"renderMesh called with non-triangulated mesh");do{if(i){var l=a.rFace().inside?0:1;s!==l&&(s=l,t.callEdgeFlagCallback(!!s))}t.callVertexCallback(a.org.data),a=a.lNext}while(a!==o.anEdge)}n&&t.callEndCallback()},e.render.renderBoundary=function(t,r){for(var i=r.fHead.next;i!==r.fHead;i=i.next)if(i.inside){t.callBeginCallback(e.primitiveType.GL_LINE_LOOP);var n=i.anEdge;do{t.callVertexCallback(n.org.data),n=n.lNext}while(n!==i.anEdge);t.callEndCallback()}},e.sweep={},e.sweep.SENTINEL_COORD_=4*e.GLU_TESS_MAX_COORD,e.sweep.TOLERANCE_NONZERO_=!1,e.sweep.computeInterior=function(t){t.fatalError=!1,e.sweep.removeDegenerateEdges_(t),e.sweep.initPriorityQ_(t),e.sweep.initEdgeDict_(t);for(var r;null!==(r=t.pq.extractMin());){for(;;){var i=t.pq.minimum();if(null===i||!e.geom.vertEq(i,r))break;i=t.pq.extractMin(),e.sweep.spliceMergeVertices_(t,r.anEdge,i.anEdge)}e.sweep.sweepEvent_(t,r)}var n=t.dict.getMin().getKey();t.event=n.eUp.org,e.sweep.doneEdgeDict_(t),e.sweep.donePriorityQ_(t),e.sweep.removeDegenerateFaces_(t.mesh),t.mesh.checkMesh()},e.sweep.addWinding_=function(e,t){e.winding+=t.winding,e.sym.winding+=t.sym.winding},e.sweep.edgeLeq_=function(t,r,i){var n=t.event,s=r.eUp,o=i.eUp;return s.dst()===n?o.dst()===n?e.geom.vertLeq(s.org,o.org)?e.geom.edgeSign(o.dst(),s.org,o.org)<=0:e.geom.edgeSign(s.dst(),o.org,s.org)>=0:e.geom.edgeSign(o.dst(),n,o.org)<=0:o.dst()===n?e.geom.edgeSign(s.dst(),n,s.org)>=0:e.geom.edgeEval(s.dst(),n,s.org)>=e.geom.edgeEval(o.dst(),n,o.org)},e.sweep.deleteRegion_=function(t,r){r.fixUpperEdge&&e.assert(0===r.eUp.winding),r.eUp.activeRegion=null,t.dict.deleteNode(r.nodeUp),r.nodeUp=null},e.sweep.fixUpperEdge_=function(t,r){e.assert(t.fixUpperEdge),e.mesh.deleteEdge(t.eUp),t.fixUpperEdge=!1,t.eUp=r,r.activeRegion=t},e.sweep.topLeftRegion_=function(t){var r=t.eUp.org;do{t=t.regionAbove()}while(t.eUp.org===r);if(t.fixUpperEdge){var i=e.mesh.connect(t.regionBelow().eUp.sym,t.eUp.lNext);e.sweep.fixUpperEdge_(t,i),t=t.regionAbove()}return t},e.sweep.topRightRegion_=function(e){var t=e.eUp.dst();do{e=e.regionAbove()}while(e.eUp.dst()===t);return e},e.sweep.addRegionBelow_=function(t,r,i){var n=new e.ActiveRegion;return n.eUp=i,n.nodeUp=t.dict.insertBefore(r.nodeUp,n),i.activeRegion=n,n},e.sweep.isWindingInside_=function(t,r){switch(t.windingRule){case e.windingRule.GLU_TESS_WINDING_ODD:return 0!=(1&r);case e.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==r;case e.windingRule.GLU_TESS_WINDING_POSITIVE:return r>0;case e.windingRule.GLU_TESS_WINDING_NEGATIVE:return r<0;case e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return r>=2||r<=-2}return e.assert(!1),!1},e.sweep.computeWinding_=function(t,r){r.windingNumber=r.regionAbove().windingNumber+r.eUp.winding,r.inside=e.sweep.isWindingInside_(t,r.windingNumber)},e.sweep.finishRegion_=function(t,r){var i=r.eUp,n=i.lFace;n.inside=r.inside,n.anEdge=i,e.sweep.deleteRegion_(t,r)},e.sweep.finishLeftRegions_=function(t,r,i){for(var n=r,s=r.eUp;n!==i;){n.fixUpperEdge=!1;var o=n.regionBelow(),a=o.eUp;if(a.org!==s.org){if(!o.fixUpperEdge){e.sweep.finishRegion_(t,n);break}a=e.mesh.connect(s.lPrev(),a.sym),e.sweep.fixUpperEdge_(o,a)}s.oNext!==a&&(e.mesh.meshSplice(a.oPrev(),a),e.mesh.meshSplice(s,a)),e.sweep.finishRegion_(t,n),s=o.eUp,n=o}return s},e.sweep.addRightEdges_=function(t,r,i,n,s,o){var a=!0,l=i;do{e.assert(e.geom.vertLeq(l.org,l.dst())),e.sweep.addRegionBelow_(t,r,l.sym),l=l.oNext}while(l!==n);null===s&&(s=r.regionBelow().eUp.rPrev());for(var u,p=r,h=s;(l=(u=p.regionBelow()).eUp.sym).org===h.org;)l.oNext!==h&&(e.mesh.meshSplice(l.oPrev(),l),e.mesh.meshSplice(h.oPrev(),l)),u.windingNumber=p.windingNumber-l.winding,u.inside=e.sweep.isWindingInside_(t,u.windingNumber),p.dirty=!0,!a&&e.sweep.checkForRightSplice_(t,p)&&(e.sweep.addWinding_(l,h),e.sweep.deleteRegion_(t,p),e.mesh.deleteEdge(h)),a=!1,p=u,h=l;p.dirty=!0,e.assert(p.windingNumber-l.winding===u.windingNumber),o&&e.sweep.walkDirtyRegions_(t,p)},e.sweep.callCombine_=function(t,r,i,n,s){var o=[r.coords[0],r.coords[1],r.coords[2]];r.data=null,r.data=t.callCombineCallback(o,i,n),null===r.data&&(s?t.fatalError||(t.callErrorCallback(e.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),t.fatalError=!0):r.data=i[0])},e.sweep.spliceMergeVertices_=function(t,r,i){var n=[null,null,null,null];n[0]=r.org.data,n[1]=i.org.data,e.sweep.callCombine_(t,r.org,n,[.5,.5,0,0],!1),e.mesh.meshSplice(r,i)},e.sweep.vertexWeights_=function(t,r,i,n,s){var o=e.geom.vertL1dist(r,t),a=e.geom.vertL1dist(i,t),l=s,u=s+1;n[l]=.5*a/(o+a),n[u]=.5*o/(o+a),t.coords[0]+=n[l]*r.coords[0]+n[u]*i.coords[0],t.coords[1]+=n[l]*r.coords[1]+n[u]*i.coords[1],t.coords[2]+=n[l]*r.coords[2]+n[u]*i.coords[2]},e.sweep.getIntersectData_=function(t,r,i,n,s,o){var a=[0,0,0,0],l=[i.data,n.data,s.data,o.data];r.coords[0]=r.coords[1]=r.coords[2]=0,e.sweep.vertexWeights_(r,i,n,a,0),e.sweep.vertexWeights_(r,s,o,a,2),e.sweep.callCombine_(t,r,l,a,!0)},e.sweep.checkForRightSplice_=function(t,r){var i=r.regionBelow(),n=r.eUp,s=i.eUp;if(e.geom.vertLeq(n.org,s.org)){if(e.geom.edgeSign(s.dst(),n.org,s.org)>0)return!1;e.geom.vertEq(n.org,s.org)?n.org!==s.org&&(t.pq.remove(n.org.pqHandle),e.sweep.spliceMergeVertices_(t,s.oPrev(),n)):(e.mesh.splitEdge(s.sym),e.mesh.meshSplice(n,s.oPrev()),r.dirty=i.dirty=!0)}else{if(e.geom.edgeSign(n.dst(),s.org,n.org)<0)return!1;r.regionAbove().dirty=r.dirty=!0,e.mesh.splitEdge(n.sym),e.mesh.meshSplice(s.oPrev(),n)}return!0},e.sweep.checkForLeftSplice_=function(t,r){var i,n=r.regionBelow(),s=r.eUp,o=n.eUp;if(e.assert(!e.geom.vertEq(s.dst(),o.dst())),e.geom.vertLeq(s.dst(),o.dst())){if(e.geom.edgeSign(s.dst(),o.dst(),s.org)<0)return!1;r.regionAbove().dirty=r.dirty=!0,i=e.mesh.splitEdge(s),e.mesh.meshSplice(o.sym,i),i.lFace.inside=r.inside}else{if(e.geom.edgeSign(o.dst(),s.dst(),o.org)>0)return!1;r.dirty=n.dirty=!0,i=e.mesh.splitEdge(o),e.mesh.meshSplice(s.lNext,o.sym),i.rFace().inside=r.inside}return!0},e.sweep.checkForIntersect_=function(t,r){var i=r.regionBelow(),n=r.eUp,s=i.eUp,o=n.org,a=s.org,l=n.dst(),u=s.dst(),p=new e.GluVertex;if(e.assert(!e.geom.vertEq(u,l)),e.assert(e.geom.edgeSign(l,t.event,o)<=0),e.assert(e.geom.edgeSign(u,t.event,a)>=0),e.assert(o!==t.event&&a!==t.event),e.assert(!r.fixUpperEdge&&!i.fixUpperEdge),o===a)return!1;if(Math.min(o.t,l.t)>Math.max(a.t,u.t))return!1;if(e.geom.vertLeq(o,a)){if(e.geom.edgeSign(u,o,a)>0)return!1}else if(e.geom.edgeSign(l,a,o)<0)return!1;e.geom.edgeIntersect(l,o,u,a,p),e.assert(Math.min(o.t,l.t)<=p.t),e.assert(p.t<=Math.max(a.t,u.t)),e.assert(Math.min(u.s,l.s)<=p.s),e.assert(p.s<=Math.max(a.s,o.s)),e.geom.vertLeq(p,t.event)&&(p.s=t.event.s,p.t=t.event.t);var h=e.geom.vertLeq(o,a)?o:a;if(e.geom.vertLeq(h,p)&&(p.s=h.s,p.t=h.t),e.geom.vertEq(p,o)||e.geom.vertEq(p,a))return e.sweep.checkForRightSplice_(t,r),!1;if(!e.geom.vertEq(l,t.event)&&e.geom.edgeSign(l,t.event,p)>=0||!e.geom.vertEq(u,t.event)&&e.geom.edgeSign(u,t.event,p)<=0){if(u===t.event)return e.mesh.splitEdge(n.sym),e.mesh.meshSplice(s.sym,n),n=(r=e.sweep.topLeftRegion_(r)).regionBelow().eUp,e.sweep.finishLeftRegions_(t,r.regionBelow(),i),e.sweep.addRightEdges_(t,r,n.oPrev(),n,n,!0),!0;if(l===t.event){e.mesh.splitEdge(s.sym),e.mesh.meshSplice(n.lNext,s.oPrev()),i=r;var c=(r=e.sweep.topRightRegion_(r)).regionBelow().eUp.rPrev();return i.eUp=s.oPrev(),s=e.sweep.finishLeftRegions_(t,i,null),e.sweep.addRightEdges_(t,r,s.oNext,n.rPrev(),c,!0),!0}return e.geom.edgeSign(l,t.event,p)>=0&&(r.regionAbove().dirty=r.dirty=!0,e.mesh.splitEdge(n.sym),n.org.s=t.event.s,n.org.t=t.event.t),e.geom.edgeSign(u,t.event,p)<=0&&(r.dirty=i.dirty=!0,e.mesh.splitEdge(s.sym),s.org.s=t.event.s,s.org.t=t.event.t),!1}return e.mesh.splitEdge(n.sym),e.mesh.splitEdge(s.sym),e.mesh.meshSplice(s.oPrev(),n),n.org.s=p.s,n.org.t=p.t,n.org.pqHandle=t.pq.insert(n.org),e.sweep.getIntersectData_(t,n.org,o,l,a,u),r.regionAbove().dirty=r.dirty=i.dirty=!0,!1},e.sweep.walkDirtyRegions_=function(t,r){for(var i=r.regionBelow();;){for(;i.dirty;)r=i,i=i.regionBelow();if(!r.dirty&&(i=r,null===(r=r.regionAbove())||!r.dirty))return;r.dirty=!1;var n=r.eUp,s=i.eUp;if(n.dst()!==s.dst()&&e.sweep.checkForLeftSplice_(t,r)&&(i.fixUpperEdge?(e.sweep.deleteRegion_(t,i),e.mesh.deleteEdge(s),s=(i=r.regionBelow()).eUp):r.fixUpperEdge&&(e.sweep.deleteRegion_(t,r),e.mesh.deleteEdge(n),n=(r=i.regionAbove()).eUp)),n.org!==s.org)if(n.dst()===s.dst()||r.fixUpperEdge||i.fixUpperEdge||n.dst()!==t.event&&s.dst()!==t.event)e.sweep.checkForRightSplice_(t,r);else if(e.sweep.checkForIntersect_(t,r))return;n.org===s.org&&n.dst()===s.dst()&&(e.sweep.addWinding_(s,n),e.sweep.deleteRegion_(t,r),e.mesh.deleteEdge(n),r=i.regionAbove())}},e.sweep.connectRightVertex_=function(t,r,i){var n,s=i.oNext,o=r.regionBelow(),a=r.eUp,l=o.eUp,u=!1;(a.dst()!==l.dst()&&e.sweep.checkForIntersect_(t,r),e.geom.vertEq(a.org,t.event)&&(e.mesh.meshSplice(s.oPrev(),a),s=(r=e.sweep.topLeftRegion_(r)).regionBelow().eUp,e.sweep.finishLeftRegions_(t,r.regionBelow(),o),u=!0),e.geom.vertEq(l.org,t.event)&&(e.mesh.meshSplice(i,l.oPrev()),i=e.sweep.finishLeftRegions_(t,o,null),u=!0),u)?e.sweep.addRightEdges_(t,r,i.oNext,s,s,!0):(n=e.geom.vertLeq(l.org,a.org)?l.oPrev():a,n=e.mesh.connect(i.lPrev(),n),e.sweep.addRightEdges_(t,r,n,n.oNext,n.oNext,!1),n.sym.activeRegion.fixUpperEdge=!0,e.sweep.walkDirtyRegions_(t,r))},e.sweep.connectLeftDegenerate_=function(t,r,i){var n=r.eUp;if(e.geom.vertEq(n.org,i))return e.assert(e.sweep.TOLERANCE_NONZERO_),void(e.sweep.TOLERANCE_NONZERO_&&e.sweep.spliceMergeVertices_(t,n,i.anEdge));if(!e.geom.vertEq(n.dst(),i))return e.mesh.splitEdge(n.sym),r.fixUpperEdge&&(e.mesh.deleteEdge(n.oNext),r.fixUpperEdge=!1),e.mesh.meshSplice(i.anEdge,n),void e.sweep.sweepEvent_(t,i);if(e.assert(e.sweep.TOLERANCE_NONZERO_),e.sweep.TOLERANCE_NONZERO_){var s=(r=e.sweep.topRightRegion_(r)).regionBelow(),o=s.eUp.sym,a=o.oNext,l=a;s.fixUpperEdge&&(e.assert(a!==o),e.sweep.deleteRegion_(t,s),e.mesh.deleteEdge(o),o=a.oPrev()),e.mesh.meshSplice(i.anEdge,o),e.geom.edgeGoesLeft(a)||(a=null),e.sweep.addRightEdges_(t,r,o.oNext,l,a,!0)}},e.sweep.connectLeftVertex_=function(t,r){var i=new e.ActiveRegion;i.eUp=r.anEdge.sym;var n=t.dict.search(i).getKey(),s=n.regionBelow(),o=n.eUp,a=s.eUp;if(0!==e.geom.edgeSign(o.dst(),r,o.org)){var l,u=e.geom.vertLeq(a.dst(),o.dst())?n:s;n.inside||u.fixUpperEdge?(l=u===n?e.mesh.connect(r.anEdge.sym,o.lNext):e.mesh.connect(a.dNext(),r.anEdge).sym,u.fixUpperEdge?e.sweep.fixUpperEdge_(u,l):e.sweep.computeWinding_(t,e.sweep.addRegionBelow_(t,n,l)),e.sweep.sweepEvent_(t,r)):e.sweep.addRightEdges_(t,n,r.anEdge,r.anEdge,null,!0)}else e.sweep.connectLeftDegenerate_(t,n,r)},e.sweep.sweepEvent_=function(t,r){t.event=r;for(var i=r.anEdge;null===i.activeRegion;)if((i=i.oNext)===r.anEdge)return void e.sweep.connectLeftVertex_(t,r);var n=e.sweep.topLeftRegion_(i.activeRegion),s=n.regionBelow(),o=s.eUp,a=e.sweep.finishLeftRegions_(t,s,null);a.oNext===o?e.sweep.connectRightVertex_(t,n,a):e.sweep.addRightEdges_(t,n,a.oNext,o,o,!0)},e.sweep.addSentinel_=function(t,r){var i=new e.ActiveRegion,n=e.mesh.makeEdge(t.mesh);n.org.s=e.sweep.SENTINEL_COORD_,n.org.t=r,n.dst().s=-e.sweep.SENTINEL_COORD_,n.dst().t=r,t.event=n.dst(),i.eUp=n,i.windingNumber=0,i.inside=!1,i.fixUpperEdge=!1,i.sentinel=!0,i.dirty=!1,i.nodeUp=t.dict.insert(i)},e.sweep.initEdgeDict_=function(t){t.dict=new e.Dict(t,e.sweep.edgeLeq_),e.sweep.addSentinel_(t,-e.sweep.SENTINEL_COORD_),e.sweep.addSentinel_(t,e.sweep.SENTINEL_COORD_)},e.sweep.doneEdgeDict_=function(t){for(var r,i=0;null!==(r=t.dict.getMin().getKey());)r.sentinel||(e.assert(r.fixUpperEdge),e.assert(1==++i)),e.assert(0===r.windingNumber),e.sweep.deleteRegion_(t,r);t.dict=null},e.sweep.removeDegenerateEdges_=function(t){for(var r,i=t.mesh.eHead,n=i.next;n!==i;n=r){r=n.next;var s=n.lNext;e.geom.vertEq(n.org,n.dst())&&n.lNext.lNext!==n&&(e.sweep.spliceMergeVertices_(t,s,n),e.mesh.deleteEdge(n),s=(n=s).lNext),s.lNext===n&&(s!==n&&(s!==r&&s!==r.sym||(r=r.next),e.mesh.deleteEdge(s)),n!==r&&n!==r.sym||(r=r.next),e.mesh.deleteEdge(n))}},e.sweep.initPriorityQ_=function(t){var r=new e.PriorityQ;t.pq=r;var i,n=t.mesh.vHead;for(i=n.next;i!==n;i=i.next)i.pqHandle=r.insert(i);r.init()},e.sweep.donePriorityQ_=function(e){e.pq.deleteQ(),e.pq=null},e.sweep.removeDegenerateFaces_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r){r=i.next;var n=i.anEdge;e.assert(n.lNext!==n),n.lNext.lNext===n&&(e.sweep.addWinding_(n.oNext,n),e.mesh.deleteEdge(n))}},e.tessmono={},e.tessmono.tessellateMonoRegion_=function(t){var r=t.anEdge;for(e.assert(r.lNext!==r&&r.lNext.lNext!==r);e.geom.vertLeq(r.dst(),r.org);r=r.lPrev());for(;e.geom.vertLeq(r.org,r.dst());r=r.lNext);for(var i=r.lPrev();r.lNext!==i;)if(e.geom.vertLeq(r.dst(),i.org)){for(;i.lNext!==r&&(e.geom.edgeGoesLeft(i.lNext)||e.geom.edgeSign(i.org,i.dst(),i.lNext.dst())<=0);)i=e.mesh.connect(i.lNext,i).sym;i=i.lPrev()}else{for(;i.lNext!==r&&(e.geom.edgeGoesRight(r.lPrev())||e.geom.edgeSign(r.dst(),r.org,r.lPrev().org)>=0);)r=e.mesh.connect(r,r.lPrev()).sym;r=r.lNext}for(e.assert(i.lNext!==r);i.lNext.lNext!==r;)i=e.mesh.connect(i.lNext,i).sym},e.tessmono.tessellateInterior=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)r=i.next,i.inside&&e.tessmono.tessellateMonoRegion_(i)},e.tessmono.discardExterior=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)r=i.next,i.inside||e.mesh.zapFace(i)},e.tessmono.setWindingNumber=function(t,r,i){for(var n,s=t.eHead.next;s!==t.eHead;s=n)n=s.next,s.rFace().inside!==s.lFace.inside?s.winding=s.lFace.inside?r:-r:i?e.mesh.deleteEdge(s):s.winding=0},e.Dict=function(t,r){this.head_=new e.DictNode,this.frame_=t,this.leq_=r},e.Dict.prototype.deleteDict_=function(){},e.Dict.prototype.insertBefore=function(t,r){do{t=t.prev}while(null!==t.key&&!this.leq_(this.frame_,t.key,r));var i=new e.DictNode(r,t.next,t);return t.next.prev=i,t.next=i,i},e.Dict.prototype.insert=function(e){return this.insertBefore(this.head_,e)},e.Dict.prototype.deleteNode=function(e){e.next.prev=e.prev,e.prev.next=e.next},e.Dict.prototype.search=function(e){var t=this.head_;do{t=t.next}while(null!==t.key&&!this.leq_(this.frame_,e,t.key));return t},e.Dict.prototype.getMin=function(){return this.head_.next},e.Dict.prototype.getMax=function(){return this.head_.prev},e.DictNode=function(e,t,r){this.key=e||null,this.next=t||this,this.prev=r||this},e.DictNode.prototype.getKey=function(){return this.key},e.DictNode.prototype.getSuccessor=function(){return this.next},e.DictNode.prototype.getPredecessor=function(){return this.prev},e.GluTesselator=function(){this.state_=e.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null,this.errorCallback_=null,this.normal_=[0,0,0],this.windingRule=e.windingRule.GLU_TESS_WINDING_ODD,this.fatalError=!1,this.dict=null,this.pq=null,this.event=null,this.combineCallback_=null,this.boundaryOnly_=!1,this.beginCallback_=null,this.edgeFlagCallback_=null,this.vertexCallback_=null,this.endCallback_=null,this.meshCallback_=null,this.polygonData_=null},e.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2},e.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(e.GluTesselator.tessState_.T_DORMANT)},e.GluTesselator.prototype.gluTessProperty=function(t,r){switch(t){case e.gluEnum.GLU_TESS_TOLERANCE:return;case e.gluEnum.GLU_TESS_WINDING_RULE:var i=r;switch(i){case e.windingRule.GLU_TESS_WINDING_ODD:case e.windingRule.GLU_TESS_WINDING_NONZERO:case e.windingRule.GLU_TESS_WINDING_POSITIVE:case e.windingRule.GLU_TESS_WINDING_NEGATIVE:case e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return void(this.windingRule=i)}break;case e.gluEnum.GLU_TESS_BOUNDARY_ONLY:return void(this.boundaryOnly_=!!r);default:return void this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM)}this.callErrorCallback(e.gluEnum.GLU_INVALID_VALUE)},e.GluTesselator.prototype.gluGetTessProperty=function(t){switch(t){case e.gluEnum.GLU_TESS_TOLERANCE:return 0;case e.gluEnum.GLU_TESS_WINDING_RULE:var r=this.windingRule;return e.assert(r===e.windingRule.GLU_TESS_WINDING_ODD||r===e.windingRule.GLU_TESS_WINDING_NONZERO||r===e.windingRule.GLU_TESS_WINDING_POSITIVE||r===e.windingRule.GLU_TESS_WINDING_NEGATIVE||r===e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),r;case e.gluEnum.GLU_TESS_BOUNDARY_ONLY:return e.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM)}return!1},e.GluTesselator.prototype.gluTessNormal=function(e,t,r){this.normal_[0]=e,this.normal_[1]=t,this.normal_[2]=r},e.GluTesselator.prototype.gluTessCallback=function(t,r){var i=r||null;switch(t){case e.gluEnum.GLU_TESS_BEGIN:case e.gluEnum.GLU_TESS_BEGIN_DATA:return void(this.beginCallback_=i);case e.gluEnum.GLU_TESS_EDGE_FLAG:case e.gluEnum.GLU_TESS_EDGE_FLAG_DATA:return void(this.edgeFlagCallback_=i);case e.gluEnum.GLU_TESS_VERTEX:case e.gluEnum.GLU_TESS_VERTEX_DATA:return void(this.vertexCallback_=i);case e.gluEnum.GLU_TESS_END:case e.gluEnum.GLU_TESS_END_DATA:return void(this.endCallback_=i);case e.gluEnum.GLU_TESS_ERROR:case e.gluEnum.GLU_TESS_ERROR_DATA:return void(this.errorCallback_=i);case e.gluEnum.GLU_TESS_COMBINE:case e.gluEnum.GLU_TESS_COMBINE_DATA:return void(this.combineCallback_=i);case e.gluEnum.GLU_TESS_MESH:return void(this.meshCallback_=i);default:return void this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM)}},e.GluTesselator.prototype.gluTessVertex=function(t,r){var i=!1,n=[0,0,0];this.requireState_(e.GluTesselator.tessState_.T_IN_CONTOUR);for(var s=0;s<3;++s){var o=t[s];o<-e.GLU_TESS_MAX_COORD&&(o=-e.GLU_TESS_MAX_COORD,i=!0),o>e.GLU_TESS_MAX_COORD&&(o=e.GLU_TESS_MAX_COORD,i=!0),n[s]=o}i&&this.callErrorCallback(e.errorType.GLU_TESS_COORD_TOO_LARGE),this.addVertex_(n,r)},e.GluTesselator.prototype.gluTessBeginPolygon=function(t){this.requireState_(e.GluTesselator.tessState_.T_DORMANT),this.state_=e.GluTesselator.tessState_.T_IN_POLYGON,this.mesh=new e.GluMesh,this.polygonData_=t},e.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(e.GluTesselator.tessState_.T_IN_POLYGON),this.state_=e.GluTesselator.tessState_.T_IN_CONTOUR,this.lastEdge_=null},e.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(e.GluTesselator.tessState_.T_IN_CONTOUR),this.state_=e.GluTesselator.tessState_.T_IN_POLYGON},e.GluTesselator.prototype.gluTessEndPolygon=function(){if(this.requireState_(e.GluTesselator.tessState_.T_IN_POLYGON),this.state_=e.GluTesselator.tessState_.T_DORMANT,e.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]),e.sweep.computeInterior(this),!this.fatalError){var t=this.mesh;if(this.boundaryOnly_?e.tessmono.setWindingNumber(t,1,!0):e.tessmono.tessellateInterior(t),this.mesh.checkMesh(),this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)if(this.boundaryOnly_)e.render.renderBoundary(this,this.mesh);else{var r=!!this.edgeFlagCallback_;e.render.renderMesh(this,this.mesh,r)}if(this.meshCallback_)return e.tessmono.discardExterior(this.mesh),this.meshCallback_(this.mesh),this.mesh=null,void(this.polygonData_=null)}e.mesh.deleteMesh(this.mesh),this.polygonData_=null,this.mesh=null},e.GluTesselator.prototype.requireState_=function(e){this.state_!==e&&this.gotoState_(e)},e.GluTesselator.prototype.gotoState_=function(t){for(;this.state_!==t;)if(this.state_<t)switch(this.state_){case e.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_BEGIN_POLYGON),this.gluTessBeginPolygon(null);break;case e.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case e.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_END_CONTOUR),this.gluTessEndContour();break;case e.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}},e.GluTesselator.prototype.addVertex_=function(t,r){var i=this.lastEdge_;null===i?(i=e.mesh.makeEdge(this.mesh),e.mesh.meshSplice(i,i.sym)):(e.mesh.splitEdge(i),i=i.lNext),i.org.data=r,i.org.coords[0]=t[0],i.org.coords[1]=t[1],i.org.coords[2]=t[2],i.winding=1,i.sym.winding=-1,this.lastEdge_=i},e.GluTesselator.prototype.callBeginCallback=function(e){this.beginCallback_&&this.beginCallback_(e,this.polygonData_)},e.GluTesselator.prototype.callVertexCallback=function(e){this.vertexCallback_&&this.vertexCallback_(e,this.polygonData_)},e.GluTesselator.prototype.callEdgeFlagCallback=function(e){this.edgeFlagCallback_&&this.edgeFlagCallback_(e,this.polygonData_)},e.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)},e.GluTesselator.prototype.callCombineCallback=function(e,t,r){return this.combineCallback_&&this.combineCallback_(e,t,r,this.polygonData_)||null},e.GluTesselator.prototype.callErrorCallback=function(e){this.errorCallback_&&this.errorCallback_(e,this.polygonData_)},e.GluFace=function(e,t){this.next=e||this,this.prev=t||this,this.anEdge=null,this.inside=!1},e.GluHalfEdge=function(e){this.next=e||this,this.sym=null,this.oNext=null,this.lNext=null,this.org=null,this.lFace=null,this.activeRegion=null,this.winding=0},e.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace},e.GluHalfEdge.prototype.dst=function(){return this.sym.org},e.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext},e.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym},e.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym},e.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext},e.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym},e.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym},e.GluMesh=function(){this.vHead=new e.GluVertex,this.fHead=new e.GluFace,this.eHead=new e.GluHalfEdge,this.eHeadSym=new e.GluHalfEdge,this.eHead.sym=this.eHeadSym,this.eHeadSym.sym=this.eHead},e.GluMesh.prototype.checkMesh=function(){if(e.DEBUG){var t,r,i=this.fHead,n=this.vHead,s=this.eHead,o=i;for(o=i;(r=o.next)!==i;o=r){e.assert(r.prev===o),t=r.anEdge;do{e.assert(t.sym!==t),e.assert(t.sym.sym===t),e.assert(t.lNext.oNext.sym===t),e.assert(t.oNext.sym.lNext===t),e.assert(t.lFace===r),t=t.lNext}while(t!==r.anEdge)}e.assert(r.prev===o&&null===r.anEdge);var a,l=n;for(l=n;(a=l.next)!==n;l=a){e.assert(a.prev===l),t=a.anEdge;do{e.assert(t.sym!==t),e.assert(t.sym.sym===t),e.assert(t.lNext.oNext.sym===t),e.assert(t.oNext.sym.lNext===t),e.assert(t.org===a),t=t.oNext}while(t!==a.anEdge)}e.assert(a.prev===l&&null===a.anEdge&&null===a.data);var u=s;for(u=s;(t=u.next)!==s;u=t)e.assert(t.sym.next===u.sym),e.assert(t.sym!==t),e.assert(t.sym.sym===t),e.assert(null!==t.org),e.assert(null!==t.dst()),e.assert(t.lNext.oNext.sym===t),e.assert(t.oNext.sym.lNext===t);e.assert(t.sym.next===u.sym&&t.sym===this.eHeadSym&&t.sym.sym===t&&null===t.org&&null===t.dst()&&null===t.lFace&&null===t.rFace())}},e.GluVertex=function(e,t){this.next=e||this,this.prev=t||this,this.anEdge=null,this.data=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0},e.PriorityQ=function(){this.verts_=[],this.order_=null,this.size_=0,this.initialized_=!1,this.heap_=new e.PriorityQHeap},e.PriorityQ.prototype.deleteQ=function(){this.heap_=null,this.order_=null,this.verts_=null},e.PriorityQ.prototype.init=function(){this.order_=[];for(var t=0;t<this.size_;t++)this.order_[t]=t;var r=function(t){return function(r,i){return e.geom.vertLeq(t[r],t[i])?1:-1}}(this.verts_);if(this.order_.sort(r),this.initialized_=!0,this.heap_.init(),e.DEBUG){var i=0+this.size_-1;for(t=0;t<i;++t)e.assert(e.geom.vertLeq(this.verts_[this.order_[t+1]],this.verts_[this.order_[t]]))}},e.PriorityQ.prototype.insert=function(e){if(this.initialized_)return this.heap_.insert(e);var t=this.size_++;return this.verts_[t]=e,-(t+1)},e.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var t=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var r=this.heap_.minimum();if(e.geom.vertLeq(r,t))return this.heap_.extractMin()}do{--this.size_}while(this.size_>0&&null===this.verts_[this.order_[this.size_-1]]);return t},e.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var t=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var r=this.heap_.minimum();if(e.geom.vertLeq(r,t))return r}return t},e.PriorityQ.prototype.remove=function(t){if(t>=0)this.heap_.remove(t);else for(t=-(t+1),e.assert(t<this.verts_.length&&null!==this.verts_[t]),this.verts_[t]=null;this.size_>0&&null===this.verts_[this.order_[this.size_-1]];)--this.size_},e.PriorityQHeap=function(){this.heap_=e.PriorityQHeap.reallocNumeric_([0],e.PriorityQHeap.INIT_SIZE_+1),this.verts_=[null,null],this.handles_=[0,0],this.size_=0,this.max_=e.PriorityQHeap.INIT_SIZE_,this.freeList_=0,this.initialized_=!1,this.heap_[1]=1},e.PriorityQHeap.INIT_SIZE_=32,e.PriorityQHeap.reallocNumeric_=function(e,t){for(var r=new Array(t),i=0;i<e.length;i++)r[i]=e[i];for(;i<t;i++)r[i]=0;return r},e.PriorityQHeap.prototype.init=function(){for(var e=this.size_;e>=1;--e)this.floatDown_(e);this.initialized_=!0},e.PriorityQHeap.prototype.insert=function(t){var r,i=++this.size_;return 2*i>this.max_&&(this.max_*=2,this.handles_=e.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1)),0===this.freeList_?r=i:(r=this.freeList_,this.freeList_=this.handles_[this.freeList_]),this.verts_[r]=t,this.handles_[r]=i,this.heap_[i]=r,this.initialized_&&this.floatUp_(i),r},e.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_},e.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]},e.PriorityQHeap.prototype.extractMin=function(){var e=this.heap_,t=this.verts_,r=this.handles_,i=e[1],n=t[i];return this.size_>0&&(e[1]=e[this.size_],r[e[1]]=1,t[i]=null,r[i]=this.freeList_,this.freeList_=i,--this.size_>0&&this.floatDown_(1)),n},e.PriorityQHeap.prototype.remove=function(t){var r=this.heap_,i=this.verts_,n=this.handles_;e.assert(t>=1&&t<=this.max_&&null!==i[t]);var s=n[t];if(r[s]=r[this.size_],n[r[s]]=s,s<=--this.size_)if(s<=1)this.floatDown_(s);else{var o=i[r[s]],a=i[r[s>>1]];e.geom.vertLeq(a,o)?this.floatDown_(s):this.floatUp_(s)}i[t]=null,n[t]=this.freeList_,this.freeList_=t},e.PriorityQHeap.prototype.floatDown_=function(t){for(var r=this.heap_,i=this.verts_,n=this.handles_,s=t,o=r[s];;){var a=s<<1;a<this.size_&&e.geom.vertLeq(i[r[a+1]],i[r[a]])&&(a+=1),e.assert(a<=this.max_);var l=r[a];if(a>this.size_||e.geom.vertLeq(i[o],i[l]))return r[s]=o,void(n[o]=s);r[s]=l,n[l]=s,s=a}},e.PriorityQHeap.prototype.floatUp_=function(t){for(var r=this.heap_,i=this.verts_,n=this.handles_,s=t,o=r[s];;){var a=s>>1,l=r[a];if(0===a||e.geom.vertLeq(i[l],i[o]))return r[s]=o,void(n[o]=s);r[s]=l,n[l]=s,s=a}},e.ActiveRegion=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},e.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()},e.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()},e}.apply(null,[]))||(e.exports=i)},1724:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(7),r(32),r(439),r(419),r(414),r(1431),r(1298),r(1636),r(1435),r(1537),r(1440),r(1531),r(1473),r(1618)],void 0===(n=function(e,t,r,i,n,s,o,a,l,u,p,h,c,d,f,g,v){Object.defineProperty(t,"__esModule",{value:!0});var _=i.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),m=24,y=10,x=1.2*m,b=10*m,w=h.i8888to32(255,255,255,255),E={xOffset:0,yOffset:0,width:0,height:0},S=function(e){function t(t,r,i){var s=e.call(this)||this;s.geometryType=u.WGLGeometryType.LABEL,s.vvFlags=0,s._textBoxVerticalOffset=0,s._textBoxHorizontalOffset=0,s._refTemplate=E,s._xOffset=r.xoffset,s._yOffset=-r.yoffset,s._decorationOffset=p.getFontDecorationOffset(r.font);var a=r.haloColor;s._color=0|(r.color&&l.premultiplyAlphaRGBA(r.color));var h=r.xoffset/r.font.size,c=r.yoffset/r.font.size;s._shapingXOffset=h*m,s._shapingYOffset=c*m,s._haloColor=0|(a&&l.premultiplyAlphaRGBA(a)),s._haloSize=y*n.pt2px(n.toPt(r.haloSize||0)),s._textPropSize=n.pt2px(r.font.size),s._textPropAngle=r.angle*Math.PI/180,s._textPropHJustification="left"===r.horizontalAlignment?0:"right"===r.horizontalAlignment?1:.5;var d=0,f=.5;switch(i){case"above-center":case"above-left":case"above-right":d=-.5,f=0;break;case"below-center":case"below-left":case"below-right":d=.5,f=1}var g=0,v=.5;switch(i){case"above-left":case"center-left":case"below-left":g=-.5,v=1;break;case"above-right":case"center-right":case"below-right":g=.5,v=0}return s._textPropHAnchorPlacement=v,s._textPropVAnchorPlacement=f,s._placementDirection=[g,d],s._materialStore=t,s.symbolId=r.id,s.anchor=o.create(),s}return r(t,e),t.fromText=function(e,r,i,n,s,o){return new t(e,i,s)},Object.defineProperty(t.prototype,"bounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0}),t.prototype.computeGlyphs=function(e,t){var r=t.text;if(!r||!r.length)return this._computedGlyphs=[],1;var i=this._shapingXOffset,n=this._shapingYOffset,a=this._computeShaping(e,b,x,0,i,n,this._textPropHAnchorPlacement,this._textPropVAnchorPlacement,this._textPropHJustification).getShaping(r,t.rtl);isNaN(this._decorationOffset)||c.addDecoration(a,this._decorationOffset);for(var l=new Array(a.length),p=0;p<a.length;p++){var h=this._textPropAngle,d=this._textPropSize,g=this._haloSize,_=a[p].glyphMosaicItem,y=this._materialStore.createGlyphMaterial(_,u.WGLGeometryType.LABEL,this.vvFlags);l[p]=v.ComputedGlyph.from(a[p],y,h,d,g)}if(this._computedGlyphs=l,!a||0===a.length)return 2;var w=c.getBox(a),E=this._textPropSize/m;w.width*=E,w.height*=E,w.x*=E,w.y*=E,this._placementDirection[0]<0?this._textBoxHorizontalOffset=-w.x-w.width:this._placementDirection[0]>0&&(this._textBoxHorizontalOffset=-w.x),this._placementDirection[1]<0?this._textBoxVerticalOffset=-w.y:this._placementDirection[1]>0&&(this._textBoxVerticalOffset=-w.y+w.height);var S=w.width/2,L=w.height/2;if(this._textPropAngle){var T=o.fromValues(-S,-L),I=o.fromValues(S,L),V=s.create();s.rotate(V,V,this._textPropAngle),o.transformMat2d(T,T,V),o.transformMat2d(I,I,V);var N=Math.abs(I[0]-T[0]),G=Math.abs(I[1]-T[1]);w.width=N,w.height=G}var O=new f.default(w.x,w.y,w.width+10,w.height+10);this._bounds=O;var C=this._placementDirection[0]*(this._refTemplate.width+this._bounds.width),R=this._placementDirection[1]*(this._refTemplate.height+this._bounds.height);return this._bounds.center[0]=C+this._xOffset,this._bounds.center[1]=R+this._yOffset,0},t.prototype.bindReferenceTemplate=function(e){this._refTemplate=e||E},t.prototype.computeAnchor=function(e,t){var r=this._refTemplate.xOffset,i=this._refTemplate.yOffset;switch(e){case"esriGeometryPoint":var n=t.geometry,s=n.x,a=n.y;this._setAnchor(s,a);break;case"esriGeometryMultipoint":var l=t.geometry,u=this._computeAnchorMultipoint(l.points);s=u.x,a=u.y;this._setAnchor(s,a);break;case"esriGeometryPolygon":if(t.centroid){var p=t.centroid,h=p.x,c=p.y;this._setAnchor(h,c);break}l=t.geometry;if(!(d=this._computeAnchorRings(l.rings)))break;s=d.x,a=d.y;this._setAnchor(s,a);break;case"esriGeometryPolyline":var d;l=t.geometry;if(!(d=this._computeAnchorRings(l.paths)))break;s=d.x,a=d.y;this._setAnchor(s,a);break;default:_.error("Unable to handle geometryType: "+e)}return o.fromValues(this.anchor[0]+r,this.anchor[1]+i)},t.prototype.writeMesh=function(e,t,r,i,n,s,o){var a=t.indexVector,l=t.get("geometry"),u=t.get("visibility"),p=t.get("visibilityRange"),c=this._getOffset(l),d=this._placementDirection[0]*(this._refTemplate.width+10)+this._textBoxHorizontalOffset,f=this._placementDirection[1]*(this._refTemplate.height+10)+this._textBoxVerticalOffset,g=h.i8888to32(this._refTemplate.xOffset,-this._refTemplate.yOffset,d,f);this._writeVertices(e,a,l,u,p,i,c,g,this.anchor[0],this.anchor[1])},t.prototype._setAnchor=function(e,t){this.anchor[0]=e,this.anchor[1]=t},t.prototype._computeAnchorMultipoint=function(e){return e.length&&e[0].length?{x:e[0][0],y:e[0][1]}:null},t.prototype._computeAnchorRings=function(e){if(!e.length||!e[0].length||!e[0][0].length)return null;var t=a.ringsCentroid(e,!1);return{x:t[0],y:t[1]}},t.prototype._computeShaping=function(e,t,r,i,n,s,o,a,l){return this._shaping=new c([e],b,x,0,[n,s],o,a,l),this._shaping},t.prototype._getOffset=function(e){return e.length/5},t.prototype._writeVertices=function(e,t,r,i,n,s,o,a,l,u){var p=this._computedGlyphs,c=l,f=u,g=h.i1616to32(2*c,2*f),v=h.i1616to32(2*c+1,2*f),_=0,m=(16711680&s)>>16,y=(65280&s)>>8,x=255&s,b=h.i8888to32(0,m,y,x);if(this._haloSize)for(var w=0;w<p.length;w++,_+=4){var E=p[w].materialId,S=this._materialStore.get(E);(L=new d(s,this.geometryType,E)).vertexFrom=o+_,L.indexFrom=t.length,this._writeGlyph(L,r,i,n,b,v,this._haloColor,a,p[w],S),this._writeIndices(L,t,o+_),e.push(L)}for(w=0;w<p.length;w++,_+=4){var L;E=p[w].materialId,S=this._materialStore.get(E);(L=new d(s,this.geometryType,E)).vertexFrom=o+_,L.indexFrom=t.length,this._writeGlyph(L,r,i,n,b,g,this._color,a,p[w],S),this._writeIndices(L,t,o+_),e.push(L)}},t.prototype._writeGlyph=function(e,t,r,i,n,s,o,a,l,u){t.push(s),t.push(o),t.push(l.vertexOffsetUpperLeft),t.push(l.texFontSizeUpperLeft),t.push(a),t.push(s),t.push(o),t.push(l.vertexOffsetUpperRight),t.push(l.texFontSizeUpperRight),t.push(a),t.push(s),t.push(o),t.push(l.vertexOffsetLowerLeft),t.push(l.texFontSizeLowerLeft),t.push(a),t.push(s),t.push(o),t.push(l.vertexOffsetLowerRight),t.push(l.texFontSizeLowerRight),t.push(a),r.push(4294967295),i.push(w),i.push(w),e.vertexCount+=4},t.prototype._writeIndices=function(e,t,r){t.push(r+0),t.push(r+1),t.push(r+2),t.push(r+1),t.push(r+3),t.push(r+2),e.indexCount+=6},t}(g.default);t.default=S}.apply(null,i))||(e.exports=n)},1725:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(7),r(1314)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0});var s=i.getLogger("esri/views/2d/engine/webgl/util/Matcher"),o=function(){function e(){this._defaultResult=null}return e.prototype.size=function(){return 1},e.prototype.getDefault=function(){return this._defaultResult},e.prototype.setDefault=function(e){this._defaultResult=e},e.prototype.match=function(e,t){return this.getDefault()},e}();t.default=o;var a=function(e){function t(t,r,i,s){var o=e.call(this)||this;return o._intervals=[],o._isMaxInclusive=r,i?o._getValue=n.createArcadeFunction(i):t&&t.length?"function"==typeof t?(o._field=null,o._getValue=t):(o._field=t,o._normalizationInfo=s,o._getValue=o._getValueFromField.bind(o)):o._field=null,o}return r(t,e),t.prototype.add=function(e,t){this._intervals.push({interval:e,result:t}),this._intervals.sort(function(e,t){return e.interval.min-t.interval.min})},t.prototype.size=function(){return e.prototype.size.call(this)+this._intervals.length},t.prototype.match=function(e,t){if(!this._getValue)return this.getDefault();var r=this._getValue(e,t);if(!r&&(null===r||void 0===r||isNaN(r)))return this.getDefault();for(var i=0;i<this._intervals.length;i++){var n=this._intervals[i],s=n.interval,o=n.result,a=r>=s.min,l=this._isMaxInclusive?r<=s.max:r<s.max;if(a&&l)return o}return this.getDefault()},t.prototype._needsNormalization=function(){var e=this._normalizationInfo;return e&&(e.normalizationField||e.normalizationTotal||e.normalizationType)},t.prototype._getValueFromField=function(e){var t=e.attributes[this._field];if(!this._needsNormalization())return t;var r=this._normalizationInfo,i=r.normalizationField,n=r.normalizationTotal,o=r.normalizationType,a=!!i&&e.attributes[i];if(o)switch(o){case"field":return a?t/a:void 0;case"log":return Math.log(t)*Math.LOG10E;case"percent-of-total":return t/n*100;default:return void s.error("Found unknown normalization type: "+o)}else s.error("Normalization is required, but no type was set!")},t}(o);t.IntervalMatcher=a;var l=function(e){function t(t,r,i){var s=e.call(this)||this;return s._resultsMap=new Map,i?s._getValue=n.createArcadeFunction(i):t&&t.length?"function"==typeof t[0]?(s._fields=null,s._getValue=t[0]):(s._fields=t,s._seperator=r||"",s._getValue=s._getValueFromFields.bind(s)):s._fields=null,s}return r(t,e),t.prototype.add=function(e,t){this._resultsMap.set(e.toString(),t)},t.prototype.size=function(){return e.prototype.size.call(this)+this._resultsMap.size},t.prototype.match=function(e,t){if(!this._getValue)return this.getDefault();var r=this._getValue(e,t);if(!r&&(null===r||void 0===r))return this.getDefault();var i=r.toString();return this._resultsMap.has(i)?this._resultsMap.get(i):this.getDefault()},t.prototype._getValueFromFields=function(e){for(var t=[],r=0,i=this._fields;r<i.length;r++){var n=i[r],s=e.attributes[n];t.push(s)}return t.join(this._seperator)},t}(o);t.MapMatcher=l}.apply(null,i))||(e.exports=n)},2170:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(1475),r(8),r(7),r(2171),r(6),r(1715),r(1),r(20),r(1476),r(1453),r(415),r(1566),r(1314),r(1634),r(1635),r(1716)],void 0===(n=function(e,t,r,i,n,s,o,a,l,u,p,h,c,d,f,g,v,_,m,y){function x(e,t){switch(e){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryMultipoint":return!0;case"esriGeometryPolygon":return function(e){var t=e&&e.getSymbols();return function(e){return e&&("unique-value"===e.type||"class-breaks"===e.type)&&null!==e.backgroundFillSymbol}(e)||t.some(function(e){return"simple-fill"===e.type||"picture-fill"===e.type})}(t);default:return E.error(new s("mapview-invalid-type",e+" is not supported")),!1}}function b(e,t){v.isMarkerSymbol(e)||v.isLineSymbol(e)?t.add(e):v.isFillSymbol(e)&&(t.add(e),function(e){return e.outline&&"none"!==e.outline.style}(e)&&t.add(e.outline))}function w(e,t,r){r.has(e)||r.set(e,new Set);for(var i=r.get(e),n=t.length,s=0;s<n;s++){var o=t.charCodeAt(s);i.add(o)}}Object.defineProperty(t,"__esModule",{value:!0});var E=o.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor"),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._symbolToMosaicItemMap=new Map,t._visualSetPromises=new Map,t.type="symbol",t}return r(t,e),t.prototype.destroy=function(){this._visualSetPromises.forEach(function(e,t){e.cancel()}),this._visualSetPromises.clear(),this._symbolToMosaicItemMap.clear(),this.notifyChange("updating")},Object.defineProperty(t.prototype,"supportsTileUpdates",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelingInfo",{get:function(){return this.configuration&&this.configuration.labelingInfo?this.configuration.labelingInfo.map(function(e){return c.fromJSON(e)}):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelClassInfos",{get:function(){var e=this;return this.labelingInfo?this.labelingInfo.map(function(t){return{labelOptions:t.getOptions(e.spatialReference),labelExpression:t.getLabelExpression(),labelClass:t}}):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"factory",{get:function(){if(!this.configuration)return null;var e={fields:this.fields};return _.default.from(this.renderer,e,this._symbolToMosaicItemMap,this.service.geometryType,this.service.objectIdField,h.fromJSON(this.spatialReference),this.configuration.devicePixelRatio,this.labelingInfo)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryInfo",{get:function(){var e=this.configuration,t=e.renderer,r=e.definitionExpression,i=e.outFields,n=e.gdbVersion,s=e.historicMoment,o=this.service.geometryType,a=this._getReturnCentroid(this.rendererInfo.renderer),l=x(o,this.rendererInfo.renderer),u="esriGeometryPoint"===o||"esriGeometryMultipoint"===o||a?20:0,p=null,h=t.visualVariables;return h&&h.some(function(e){if("size"===e.type&&e.field&&!e.normalizationField)return p=[e.field+" DESC"],!0}),{definitionExpression:r,orderByFields:p,outFields:i,pixelBuffer:u,returnCentroid:a,returnGeometry:l,gdbVersion:n,historicMoment:s}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){return this.configuration?d.fromJSON(this.configuration.renderer):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rendererInfo",{get:function(){return this.configuration?g.createRendererInfo(d.fromJSON(this.configuration.renderer),this.tileStore.spatialReference,{fields:this.service.fields}):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this._visualSetPromises.size>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return this.service.fields},enumerable:!0,configurable:!0}),t.prototype.onTileData=function(e,t){var r=this,i=t.addOrUpdate,n=t.clear,s=t.remove,o=(i&&i.length?this._processFeatures(e,i):l.resolve()).then(function(t){var i=t&&t.message||null,o=t&&t.transferList||null;return r.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:{addOrUpdate:i,remove:s,clear:n}},o)}).catch(function(t){return r._handleError(e,t)});return this._visualSetPromises.set(e,o),o.then(function(){return r._cleanPromise(e)},function(){return r._cleanPromise(e)}),this.notifyChange("updating"),o},t.prototype.onTileError=function(e,t){var r=this,i=this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:e.id,error:t});return this._visualSetPromises.set(e,i),i.then(function(){return r._cleanPromise(e)},function(){return r._cleanPromise(e)}),this.notifyChange("updating"),i},t.prototype.onTileUpdate=function(e){for(var t=0,r=e.removed;t<r.length;t++){var i=r[t],n=this._visualSetPromises;if(!n.has(i))return;n.get(i).cancel(),n.delete(i),this.notifyChange("updating")}},t.prototype._cleanPromise=function(e){this._visualSetPromises.delete(e),this.notifyChange("updating")},t.prototype._processFeatures=function(e,t){var r=this;return t&&t.length?this._getMosaicItems(e,t).then(function(i){return r._writeFeatures(e,t,i)}):l.resolve(null)},t.prototype._writeFeatures=function(e,t,r){for(var i=this.factory,n=i.createMeshData(t.length),s={viewingMode:"",scale:e.scale},o=0,a=t;o<a.length;o++){var l=a[o];i.write(n,l,s,r,this._symbolToMosaicItemMap)}return this._encodeDisplayData(n)},t.prototype._encodeDisplayData=function(e){var t={},r=new Array;return e.encode(t,r),{message:t,transferList:r}},t.prototype._handleError=function(e,t){if(t&&"cancel"!==t.dojoType)return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:e.id,error:t.message})},t.prototype._getReturnCentroid=function(e){function t(e){if(!e)return!1;var t=e.type;return"simple-marker"===t||"picture-marker"===t||"text"===t}if("esriGeometryPolygon"===this.service.geometryType&&this.labelingInfo)return!0;if("esriGeometryPolygon"!==this.service.geometryType)return!1;switch(e.type){case"simple":return t(e.symbol);case"unique-value":return t(e.defaultSymbol)||e.uniqueValueInfos.some(function(e){return t(e.symbol)});case"class-breaks":return t(e.defaultSymbol)||e.classBreakInfos.some(function(e){return t(e.symbol)});default:return!0}},t.prototype._getMosaicItems=function(e,t){for(var r=u.default.acquire(),i=a.acquire(),s=this._createLabelFeatures(e.scale,t,i),o=0,p=this.renderer.getSymbols();o<p.length;o++){var h=p[o];if(v.isTextSymbol(h)){var c=h;w(c,m.bidiText(c.text)[0],i)}else b(h,r)}if(this.renderer instanceof n.UniqueValueRenderer||this.renderer instanceof n.ClassBreaksRenderer){var d=this.renderer.backgroundFillSymbol;d&&b(d,r)}var f=this._symbolToMosaicItemMap,g=a.acquire(),_=[],y=0;return r.forEach(function(e){f.has(e.id)||(g.set(y,e),_.push({symbol:e.toJSON(),id:y}),y++)}),i.forEach(function(e,t){if(f.has(t.id)){var r=f.get(t.id).glyphMosaicItems,i=[];e.forEach(function(e){(r&&r.length<e||!r[e])&&(i[e]=e)}),i.length>0&&(g.set(y,t),_.push({symbol:t.toJSON(),id:y,glyphIds:i}),y++)}else{g.set(y,t);var n=[];e.forEach(function(e){return n.push(e)}),_.push({symbol:t.toJSON(),id:y,glyphIds:n}),y++}}),_.length>0?this.remoteClient.invoke("tileRenderer.getMaterialItems",_).then(function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t],n=g.get(i.id);if(n)if(v.isTextSymbol(n))if(f.has(n.id)){var o=f.get(n.id).glyphMosaicItems,l=i.mosaicItem.glyphMosaicItems;if(l)for(var u=0;u<l.length;u++)null!=l[u]&&(o[u]=l[u])}else f.set(n.id,i.mosaicItem);else f.set(n.id,i.mosaicItem)}return a.release(g),s}):(u.default.release(r),a.release(i),l.resolve(s))},t.prototype._getLabelClassInfos=function(e){return this.labelClassInfos.map(function(e,t){return{id:t,labelClassInfo:e}}).filter(function(t){var r=t.labelClassInfo;return(!r.labelClass.minScale||r.labelClass.minScale>=e||0===r.labelClass.minScale)&&(!r.labelClass.maxScale||r.labelClass.maxScale<=e||0===r.labelClass.maxScale)})},t.prototype._createLabelFeatures=function(e,t,r){if(!this.labelingInfo||!t||0===t.length)return null;var i=this._getLabelClassInfos(e);if(0===i.length)return null;for(var n=a.acquire(),s=i.map(function(e){return e.id}),o=new _.LabelGrid(f.COLLISION_EARLY_REJECT_BUCKET_SIZE),l=0,u=t;l<u.length;l++){var p=u[l],h=this.service.geometryType,c=0,d=0;if("esriGeometryPoint"===h){var g=p.geometry;c=g.x,d=g.y}else{if("esriGeometryPolygon"!==h)return null;c=p.centroid.x,d=p.centroid.y}var v=p.attributes[this.service.objectIdField];if(!o.checkOverlap(c,d)){for(var y=new Array(i.length),x=0;x<i.length;x++){var b=i[x].labelClassInfo,E=m.bidiText(this._evaluateLabelExpression(p,b)),S=E[0],L=E[1];w(b.labelClass.symbol,S,r),y[x]={text:S,rtl:L}}n.set(v,{text:y,labelingInfo:s})}}return n},t.prototype._evaluateLabelExpression=function(e,t){return t.labelClass.symbol&&c.evaluateWhere(t.labelClass.where,e.attributes)&&t.labelExpression.expression?c.buildLabelText(t.labelExpression.expression,e,this.fields,t.labelOptions):""},i([p.property({readOnly:!0})],t.prototype,"supportsTileUpdates",null),i([p.property()],t.prototype,"configuration",void 0),i([p.property({dependsOn:["configuration"]})],t.prototype,"labelingInfo",null),i([p.property({dependsOn:["labelingInfo"]})],t.prototype,"labelClassInfos",null),i([p.property({dependsOn:["configuration","service","fields"]})],t.prototype,"factory",null),i([p.property({constructOnly:!0})],t.prototype,"queryInfo",null),i([p.property({dependsOn:["configuration"]})],t.prototype,"renderer",null),i([p.property({dependsOn:["configuration"]})],t.prototype,"rendererInfo",null),i([p.property({readOnly:!0})],t.prototype,"updating",null),i([p.property({dependsOn:["service"]})],t.prototype,"fields",null),i([p.subclass()],t)}(p.declared(y.default));t.default=S}.apply(null,i))||(e.exports=n)},2171:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(76)],void 0===(n=function(e,t,r){var i=function(){function e(e,t){void 0===e&&(e=50),void 0===t&&(t=50),this._pool=new r(Map,!1,function(e){return e.clear()},t,e)}return e.prototype.acquire=function(){return this._pool.acquire()},e.prototype.release=function(e){this._pool.release(e)},e.acquire=function(){return n.acquire()},e.release=function(e){return n.release(e)},e}(),n=new i(100);return i}.apply(null,i))||(e.exports=n)}}]);